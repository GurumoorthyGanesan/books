{
  "ID": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
  "Root": {
    "alive": true,
    "content": [
      "77c61b8d-22b8-4a09-9d18-6f8ee5bc4059",
      "0355a915-7fbc-4e9d-9125-2601cc0860cd",
      "ef87f1ae-e43d-46e7-aec2-0467d159431d",
      "6b77679e-e652-4166-a07e-328fd81d21d5",
      "d4d47e7c-37c8-4b81-b130-5909d32d5b3b",
      "a6acb22e-7b20-4326-be01-edb7431426a4",
      "cff226db-ed41-40ac-ba37-c1f128dae41d",
      "26c22c13-3fbe-491b-aee6-0320d1fcf5b3",
      "62d90f16-defb-471f-b14f-6334cbb30118",
      "be4168c2-cdbd-4dd0-9a2c-b605b4db3409",
      "89f84ca7-e915-4f4d-bb11-95c03eaac625",
      "84f5d9ad-9701-4b10-b023-7b03727fbb28",
      "fb44c8e7-22bd-45b3-a3c8-22a5af26db3e",
      "73a7cf2f-f0ec-4ba5-b08a-e42b7422e273",
      "9b1450f7-9a85-4e4b-9515-ef4aeccfdc19",
      "d2f7bf90-2219-42d2-a20f-e847e3c0e517",
      "1906ef01-3131-4286-bd53-762e3f277647",
      "656ed598-639f-4cfb-9dd5-61665ab0ab42",
      "8e670ddf-e360-4f28-8ece-598fdb930227",
      "405eed5f-57d9-4bf4-81f6-3b728277c031",
      "ba367bf2-21a9-4f84-9e01-d8f9aa236339",
      "8075efbb-fb55-4ac4-b079-b84f68b6408f",
      "7917f0c8-1ea9-44d8-9f91-c7f8d61360c4",
      "24ddea53-1519-45ca-bd21-aeae2b49c7d1",
      "00ebfb11-1b0f-47e3-ad50-4f9157db1652",
      "80e32456-4475-48f9-9691-19f9e83a400e",
      "bf2df500-2fa2-4ed3-9b74-3196efe59972",
      "eabce957-aabd-424a-b252-d39bb54443e7",
      "895e6ac1-5052-4beb-91f5-c7a62db3768e",
      "684382c9-7420-48d5-8f4f-237d06f98fcf",
      "a6bbdcf3-fd54-4a17-bfdf-12dc9dc8bf73",
      "512e3f03-de7e-40b1-952b-1ff35f16963a",
      "f1289e15-3108-4d7c-9025-00a750972f96",
      "ac13d56e-a739-49e1-805c-e4962624d1ce",
      "da3a1e70-e067-48dc-8d58-0c9297c2df90",
      "95b12eb9-fd7d-4f47-acb6-bf324a643a52"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1549528668438,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1549792320000,
    "parent_id": "f0c07076-1721-4628-bc3b-9d40618aeb3a",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Fast Asymmetric File Encryption"
        ]
      ]
    },
    "type": "page",
    "version": 8,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668432,
        "id": "77c61b8d-22b8-4a09-9d18-6f8ee5bc4059",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668432,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Asymmetric encryption is often regarded as preferable to Symmetric encryption for transferring messages to other parties. This is mainly because it negates many of the risks related to the exchange of a shared key and ensures that whilst anyone with the public key can encrypt a message for the intended recipient, only that recipient can decrypt it. Unfortunately the major down-side of asymmetric encryption algorithms is that they are significantly slower than their symmetric cousins. As such the asymmetric encryption of files, especially large ones, can often be a very computationally intensive process."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Asymmetric encryption is often regarded as preferable to Symmetric encryption for transferring messages to other parties. This is mainly because it negates many of the risks related to the exchange of a shared key and ensures that whilst anyone with the public key can encrypt a message for the intended recipient, only that recipient can decrypt it. Unfortunately the major down-side of asymmetric encryption algorithms is that they are significantly slower than their symmetric cousins. As such the asymmetric encryption of files, especially large ones, can often be a very computationally intensive process."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668435,
        "id": "0355a915-7fbc-4e9d-9125-2601cc0860cd",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668435,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "In order to provide both security AND performance, a hybrid approach can be taken. This entails the cryptographically random generation of a key and initialization vector for "
            ],
            [
              "Symmetric",
              [
                [
                  "i"
                ]
              ]
            ],
            [
              " encryption. These values are then encrypted using an "
            ],
            [
              "Asymmetric",
              [
                [
                  "i"
                ]
              ]
            ],
            [
              " algorithm and written to the output file, before being used to encrypt the source data "
            ],
            [
              "Symmetrically",
              [
                [
                  "i"
                ]
              ]
            ],
            [
              " and appending it to the output."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "In order to provide both security AND performance, a hybrid approach can be taken. This entails the cryptographically random generation of a key and initialization vector for "
          },
          {
            "Text": "Symmetric",
            "AttrFlags": 4
          },
          {
            "Text": " encryption. These values are then encrypted using an "
          },
          {
            "Text": "Asymmetric",
            "AttrFlags": 4
          },
          {
            "Text": " algorithm and written to the output file, before being used to encrypt the source data "
          },
          {
            "Text": "Symmetrically",
            "AttrFlags": 4
          },
          {
            "Text": " and appending it to the output."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668435,
        "id": "ef87f1ae-e43d-46e7-aec2-0467d159431d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668435,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "This approach provides a high degree of both performance and security, in that the data is encrypted using a symmetric algorithm (fast) and the key and iv, both randomly generated (secure) are encrypted by an asymmetric algorithm (secure). It also has the added advantage that the same payload encrypted on different occasions will have very different cyphertext, because the symmetric keys are randomly generated each time."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "This approach provides a high degree of both performance and security, in that the data is encrypted using a symmetric algorithm (fast) and the key and iv, both randomly generated (secure) are encrypted by an asymmetric algorithm (secure). It also has the added advantage that the same payload encrypted on different occasions will have very different cyphertext, because the symmetric keys are randomly generated each time."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668435,
        "id": "6b77679e-e652-4166-a07e-328fd81d21d5",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668435,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The following class demonstrates asymmetric encryption of strings and byte arrays, as well as hybrid file encryption."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "The following class demonstrates asymmetric encryption of strings and byte arrays, as well as hybrid file encryption."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668435,
        "id": "d4d47e7c-37c8-4b81-b130-5909d32d5b3b",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668435,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "public static class AsymmetricProvider\n{\n    #region Key Generation\n    public class KeyPair\n    {\n        public string PublicKey { get; set; }\n        public string PrivateKey { get; set; }\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "public static class AsymmetricProvider\n{\n    #region Key Generation\n    public class KeyPair\n    {\n        public string PublicKey { get; set; }\n        public string PrivateKey { get; set; }\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668435,
        "id": "a6acb22e-7b20-4326-be01-edb7431426a4",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668435,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "public static KeyPair GenerateNewKeyPair(int keySize = 4096)\n    {\n        // KeySize is measured in bits. 1024 is the default, 2048 is better, 4096 is more robust but takes a fair bit longer to generate.\n        using (var rsa = new RSACryptoServiceProvider(keySize))\n        {\n            return new KeyPair {PublicKey = rsa.ToXmlString(false), PrivateKey = rsa.ToXmlString(true)};\n        }\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "public static KeyPair GenerateNewKeyPair(int keySize = 4096)\n    {\n        // KeySize is measured in bits. 1024 is the default, 2048 is better, 4096 is more robust but takes a fair bit longer to generate.\n        using (var rsa = new RSACryptoServiceProvider(keySize))\n        {\n            return new KeyPair {PublicKey = rsa.ToXmlString(false), PrivateKey = rsa.ToXmlString(true)};\n        }\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668435,
        "id": "cff226db-ed41-40ac-ba37-c1f128dae41d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668435,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "#endregion\n\n    #region Asymmetric Data Encryption and Decryption"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "#endregion\n\n    #region Asymmetric Data Encryption and Decryption",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668435,
        "id": "26c22c13-3fbe-491b-aee6-0320d1fcf5b3",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668435,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "public static byte[] EncryptData(byte[] data, string publicKey)\n    {\n        using (var asymmetricProvider = new RSACryptoServiceProvider())\n        {\n            asymmetricProvider.FromXmlString(publicKey);\n            return asymmetricProvider.Encrypt(data, true);\n        }\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "public static byte[] EncryptData(byte[] data, string publicKey)\n    {\n        using (var asymmetricProvider = new RSACryptoServiceProvider())\n        {\n            asymmetricProvider.FromXmlString(publicKey);\n            return asymmetricProvider.Encrypt(data, true);\n        }\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "62d90f16-defb-471f-b14f-6334cbb30118",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "public static byte[] DecryptData(byte[] data, string publicKey)\n    {\n        using (var asymmetricProvider = new RSACryptoServiceProvider())\n        {\n            asymmetricProvider.FromXmlString(publicKey);\n            if (asymmetricProvider.PublicOnly)\n                throw new Exception(\"The key provided is a public key and does not contain the private key elements required for decryption\");\n            return asymmetricProvider.Decrypt(data, true);\n        }\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "public static byte[] DecryptData(byte[] data, string publicKey)\n    {\n        using (var asymmetricProvider = new RSACryptoServiceProvider())\n        {\n            asymmetricProvider.FromXmlString(publicKey);\n            if (asymmetricProvider.PublicOnly)\n                throw new Exception(\"The key provided is a public key and does not contain the private key elements required for decryption\");\n            return asymmetricProvider.Decrypt(data, true);\n        }\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "be4168c2-cdbd-4dd0-9a2c-b605b4db3409",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "public static string EncryptString(string value, string publicKey)\n    {\n        return Convert.ToBase64String(EncryptData(Encoding.UTF8.GetBytes(value), publicKey));\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "public static string EncryptString(string value, string publicKey)\n    {\n        return Convert.ToBase64String(EncryptData(Encoding.UTF8.GetBytes(value), publicKey));\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "89f84ca7-e915-4f4d-bb11-95c03eaac625",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "public static string DecryptString(string value, string privateKey)\n    {\n        return Encoding.UTF8.GetString(EncryptData(Convert.FromBase64String(value), privateKey));\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "public static string DecryptString(string value, string privateKey)\n    {\n        return Encoding.UTF8.GetString(EncryptData(Convert.FromBase64String(value), privateKey));\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "84f5d9ad-9701-4b10-b023-7b03727fbb28",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "#endregion\n\n    #region Hybrid File Encryption and Decription"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "#endregion\n\n    #region Hybrid File Encryption and Decription",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "fb44c8e7-22bd-45b3-a3c8-22a5af26db3e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "public static void EncryptFile(string inputFilePath, string outputFilePath, string publicKey)\n    {\n        using (var symmetricCypher = new AesManaged())\n        {\n            // Generate random key and IV for symmetric encryption\n            var key = new byte[symmetricCypher.KeySize / 8];\n            var iv = new byte[symmetricCypher.BlockSize / 8];\n            using (var rng = new RNGCryptoServiceProvider())\n            {\n                rng.GetBytes(key);\n                rng.GetBytes(iv);\n            }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "public static void EncryptFile(string inputFilePath, string outputFilePath, string publicKey)\n    {\n        using (var symmetricCypher = new AesManaged())\n        {\n            // Generate random key and IV for symmetric encryption\n            var key = new byte[symmetricCypher.KeySize / 8];\n            var iv = new byte[symmetricCypher.BlockSize / 8];\n            using (var rng = new RNGCryptoServiceProvider())\n            {\n                rng.GetBytes(key);\n                rng.GetBytes(iv);\n            }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "73a7cf2f-f0ec-4ba5-b08a-e42b7422e273",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "// Encrypt the symmetric key and IV\n            var buf = new byte[key.Length + iv.Length];\n            Array.Copy(key, buf, key.Length);\n            Array.Copy(iv, 0, buf, key.Length, iv.Length);\n            buf = EncryptData(buf, publicKey);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "// Encrypt the symmetric key and IV\n            var buf = new byte[key.Length + iv.Length];\n            Array.Copy(key, buf, key.Length);\n            Array.Copy(iv, 0, buf, key.Length, iv.Length);\n            buf = EncryptData(buf, publicKey);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "9b1450f7-9a85-4e4b-9515-ef4aeccfdc19",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "var bufLen = BitConverter.GetBytes(buf.Length);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "var bufLen = BitConverter.GetBytes(buf.Length);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "d2f7bf90-2219-42d2-a20f-e847e3c0e517",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "// Symmetrically encrypt the data and write it to the file, along with the encrypted key and iv\n            using (var cypherKey = symmetricCypher.CreateEncryptor(key, iv))\n            using (var fsIn = new FileStream(inputFilePath, FileMode.Open))\n            using (var fsOut = new FileStream(outputFilePath, FileMode.Create))\n            using (var cs = new CryptoStream(fsOut, cypherKey, CryptoStreamMode.Write))\n            {\n                fsOut.Write(bufLen,0, bufLen.Length);\n                fsOut.Write(buf, 0, buf.Length);\n                fsIn.CopyTo(cs);\n            }\n        }\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "// Symmetrically encrypt the data and write it to the file, along with the encrypted key and iv\n            using (var cypherKey = symmetricCypher.CreateEncryptor(key, iv))\n            using (var fsIn = new FileStream(inputFilePath, FileMode.Open))\n            using (var fsOut = new FileStream(outputFilePath, FileMode.Create))\n            using (var cs = new CryptoStream(fsOut, cypherKey, CryptoStreamMode.Write))\n            {\n                fsOut.Write(bufLen,0, bufLen.Length);\n                fsOut.Write(buf, 0, buf.Length);\n                fsIn.CopyTo(cs);\n            }\n        }\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "1906ef01-3131-4286-bd53-762e3f277647",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "public static void DecryptFile(string inputFilePath, string outputFilePath, string privateKey)\n    {\n        using (var symmetricCypher = new AesManaged())\n        using (var fsIn = new FileStream(inputFilePath, FileMode.Open))\n        {\n            // Determine the length of the encrypted key and IV\n            var buf = new byte[sizeof(int)];\n            fsIn.Read(buf, 0, buf.Length);\n            var bufLen = BitConverter.ToInt32(buf, 0);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "public static void DecryptFile(string inputFilePath, string outputFilePath, string privateKey)\n    {\n        using (var symmetricCypher = new AesManaged())\n        using (var fsIn = new FileStream(inputFilePath, FileMode.Open))\n        {\n            // Determine the length of the encrypted key and IV\n            var buf = new byte[sizeof(int)];\n            fsIn.Read(buf, 0, buf.Length);\n            var bufLen = BitConverter.ToInt32(buf, 0);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "656ed598-639f-4cfb-9dd5-61665ab0ab42",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "// Read the encrypted key and IV data from the file and decrypt using the asymmetric algorithm\n            buf = new byte[bufLen];\n            fsIn.Read(buf, 0, buf.Length);\n            buf = DecryptData(buf, privateKey);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "// Read the encrypted key and IV data from the file and decrypt using the asymmetric algorithm\n            buf = new byte[bufLen];\n            fsIn.Read(buf, 0, buf.Length);\n            buf = DecryptData(buf, privateKey);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "8e670ddf-e360-4f28-8ece-598fdb930227",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "var key = new byte[symmetricCypher.KeySize / 8];\n            var iv = new byte[symmetricCypher.BlockSize / 8];\n            Array.Copy(buf, key, key.Length);\n            Array.Copy(buf, key.Length, iv, 0, iv.Length);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "var key = new byte[symmetricCypher.KeySize / 8];\n            var iv = new byte[symmetricCypher.BlockSize / 8];\n            Array.Copy(buf, key, key.Length);\n            Array.Copy(buf, key.Length, iv, 0, iv.Length);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "405eed5f-57d9-4bf4-81f6-3b728277c031",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "// Decript the file data using the symmetric algorithm\n            using (var cypherKey = symmetricCypher.CreateDecryptor(key, iv))\n            using (var fsOut = new FileStream(outputFilePath, FileMode.Create))\n            using (var cs = new CryptoStream(fsOut, cypherKey, CryptoStreamMode.Write))\n            {\n                fsIn.CopyTo(cs);\n            }\n        }\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "// Decript the file data using the symmetric algorithm\n            using (var cypherKey = symmetricCypher.CreateDecryptor(key, iv))\n            using (var fsOut = new FileStream(outputFilePath, FileMode.Create))\n            using (var cs = new CryptoStream(fsOut, cypherKey, CryptoStreamMode.Write))\n            {\n                fsIn.CopyTo(cs);\n            }\n        }\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668436,
        "id": "ba367bf2-21a9-4f84-9e01-d8f9aa236339",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668436,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "#endregion\n\n    #region Key Storage"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "#endregion\n\n    #region Key Storage",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "8075efbb-fb55-4ac4-b079-b84f68b6408f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "public static void WritePublicKey(string publicKeyFilePath, string publicKey)\n    {\n        File.WriteAllText(publicKeyFilePath, publicKey);\n    }\n    public static string ReadPublicKey(string publicKeyFilePath)\n    {\n        return File.ReadAllText(publicKeyFilePath);\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "public static void WritePublicKey(string publicKeyFilePath, string publicKey)\n    {\n        File.WriteAllText(publicKeyFilePath, publicKey);\n    }\n    public static string ReadPublicKey(string publicKeyFilePath)\n    {\n        return File.ReadAllText(publicKeyFilePath);\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "7917f0c8-1ea9-44d8-9f91-c7f8d61360c4",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "private const string SymmetricSalt = \"Stack_Overflow!\"; // Change me!"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "private const string SymmetricSalt = \"Stack_Overflow!\"; // Change me!",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "24ddea53-1519-45ca-bd21-aeae2b49c7d1",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "public static string ReadPrivateKey(string privateKeyFilePath, string password)\n    {\n        var salt = Encoding.UTF8.GetBytes(SymmetricSalt);\n        var cypherText = File.ReadAllBytes(privateKeyFilePath);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "public static string ReadPrivateKey(string privateKeyFilePath, string password)\n    {\n        var salt = Encoding.UTF8.GetBytes(SymmetricSalt);\n        var cypherText = File.ReadAllBytes(privateKeyFilePath);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "00ebfb11-1b0f-47e3-ad50-4f9157db1652",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "using (var cypher = new AesManaged())\n        {\n            var pdb = new Rfc2898DeriveBytes(password, salt);\n            var key = pdb.GetBytes(cypher.KeySize / 8);\n            var iv = pdb.GetBytes(cypher.BlockSize / 8);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "using (var cypher = new AesManaged())\n        {\n            var pdb = new Rfc2898DeriveBytes(password, salt);\n            var key = pdb.GetBytes(cypher.KeySize / 8);\n            var iv = pdb.GetBytes(cypher.BlockSize / 8);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "80e32456-4475-48f9-9691-19f9e83a400e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "using (var decryptor = cypher.CreateDecryptor(key, iv))\n            using (var msDecrypt = new MemoryStream(cypherText))\n            using (var csDecrypt = new CryptoStream(msDecrypt, decryptor, CryptoStreamMode.Read))\n            using (var srDecrypt = new StreamReader(csDecrypt))\n            {\n                return srDecrypt.ReadToEnd();\n            }\n        }\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "using (var decryptor = cypher.CreateDecryptor(key, iv))\n            using (var msDecrypt = new MemoryStream(cypherText))\n            using (var csDecrypt = new CryptoStream(msDecrypt, decryptor, CryptoStreamMode.Read))\n            using (var srDecrypt = new StreamReader(csDecrypt))\n            {\n                return srDecrypt.ReadToEnd();\n            }\n        }\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "bf2df500-2fa2-4ed3-9b74-3196efe59972",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "public static void WritePrivateKey(string privateKeyFilePath, string privateKey, string password)\n    {\n        var salt = Encoding.UTF8.GetBytes(SymmetricSalt);\n        using (var cypher = new AesManaged())\n        {\n            var pdb = new Rfc2898DeriveBytes(password, salt);\n            var key = pdb.GetBytes(cypher.KeySize / 8);\n            var iv = pdb.GetBytes(cypher.BlockSize / 8);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "public static void WritePrivateKey(string privateKeyFilePath, string privateKey, string password)\n    {\n        var salt = Encoding.UTF8.GetBytes(SymmetricSalt);\n        using (var cypher = new AesManaged())\n        {\n            var pdb = new Rfc2898DeriveBytes(password, salt);\n            var key = pdb.GetBytes(cypher.KeySize / 8);\n            var iv = pdb.GetBytes(cypher.BlockSize / 8);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "eabce957-aabd-424a-b252-d39bb54443e7",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "using (var encryptor = cypher.CreateEncryptor(key, iv))\n            using (var fsEncrypt = new FileStream(privateKeyFilePath, FileMode.Create))\n            using (var csEncrypt = new CryptoStream(fsEncrypt, encryptor, CryptoStreamMode.Write))\n            using (var swEncrypt = new StreamWriter(csEncrypt))\n            {\n                swEncrypt.Write(privateKey);\n            }\n        }\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "using (var encryptor = cypher.CreateEncryptor(key, iv))\n            using (var fsEncrypt = new FileStream(privateKeyFilePath, FileMode.Create))\n            using (var csEncrypt = new CryptoStream(fsEncrypt, encryptor, CryptoStreamMode.Write))\n            using (var swEncrypt = new StreamWriter(csEncrypt))\n            {\n                swEncrypt.Write(privateKey);\n            }\n        }\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "895e6ac1-5052-4beb-91f5-c7a62db3768e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "#endregion\n}"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "#endregion\n}",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "684382c9-7420-48d5-8f4f-237d06f98fcf",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Example of use:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Example of use:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "a6bbdcf3-fd54-4a17-bfdf-12dc9dc8bf73",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "private static void HybridCryptoTest(string privateKeyPath, string privateKeyPassword, string inputPath)\n{\n    // Setup the test\n    var publicKeyPath = Path.ChangeExtension(privateKeyPath, \".public\");\n    var outputPath = Path.Combine(Path.ChangeExtension(inputPath, \".enc\"));\n    var testPath = Path.Combine(Path.ChangeExtension(inputPath, \".test\"));"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "private static void HybridCryptoTest(string privateKeyPath, string privateKeyPassword, string inputPath)\n{\n    // Setup the test\n    var publicKeyPath = Path.ChangeExtension(privateKeyPath, \".public\");\n    var outputPath = Path.Combine(Path.ChangeExtension(inputPath, \".enc\"));\n    var testPath = Path.Combine(Path.ChangeExtension(inputPath, \".test\"));",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "512e3f03-de7e-40b1-952b-1ff35f16963a",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "if (!File.Exists(privateKeyPath))\n    {\n        var keys = AsymmetricProvider.GenerateNewKeyPair(2048);\n        AsymmetricProvider.WritePublicKey(publicKeyPath, keys.PublicKey);\n        AsymmetricProvider.WritePrivateKey(privateKeyPath, keys.PrivateKey, privateKeyPassword);\n    }"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "if (!File.Exists(privateKeyPath))\n    {\n        var keys = AsymmetricProvider.GenerateNewKeyPair(2048);\n        AsymmetricProvider.WritePublicKey(publicKeyPath, keys.PublicKey);\n        AsymmetricProvider.WritePrivateKey(privateKeyPath, keys.PrivateKey, privateKeyPassword);\n    }",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668437,
        "id": "f1289e15-3108-4d7c-9025-00a750972f96",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668437,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "// Encrypt the file\n    var publicKey = AsymmetricProvider.ReadPublicKey(publicKeyPath);\n    AsymmetricProvider.EncryptFile(inputPath, outputPath, publicKey);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "// Encrypt the file\n    var publicKey = AsymmetricProvider.ReadPublicKey(publicKeyPath);\n    AsymmetricProvider.EncryptFile(inputPath, outputPath, publicKey);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668438,
        "id": "ac13d56e-a739-49e1-805c-e4962624d1ce",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668438,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "// Decrypt it again to compare against the source file\n    var privateKey = AsymmetricProvider.ReadPrivateKey(privateKeyPath, privateKeyPassword);\n    AsymmetricProvider.DecryptFile(outputPath, testPath, privateKey);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "// Decrypt it again to compare against the source file\n    var privateKey = AsymmetricProvider.ReadPrivateKey(privateKeyPath, privateKeyPassword);\n    AsymmetricProvider.DecryptFile(outputPath, testPath, privateKey);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668438,
        "id": "da3a1e70-e067-48dc-8d58-0c9297c2df90",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668438,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "// Check that the two files match\n    var source = File.ReadAllBytes(inputPath);\n    var dest = File.ReadAllBytes(testPath);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "// Check that the two files match\n    var source = File.ReadAllBytes(inputPath);\n    var dest = File.ReadAllBytes(testPath);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528668438,
        "id": "95b12eb9-fd7d-4f47-acb6-bf324a643a52",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528668438,
        "parent_id": "8b0184ab-afca-426b-9625-8c2fdf6f2529",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "if (source.Length != dest.Length)\n        throw new Exception(\"Length does not match\");"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "if (source.Length != dest.Length)\n        throw new Exception(\"Length does not match\");",
        "code_language": "Plain Text"
      }
    ],
    "title": "Fast Asymmetric File Encryption",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 18
    }
  ],
  "Tables": null
}