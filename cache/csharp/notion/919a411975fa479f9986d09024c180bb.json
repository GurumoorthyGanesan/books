{
  "ID": "919a4119-75fa-479f-9986-d09024c180bb",
  "Root": {
    "id": "919a4119-75fa-479f-9986-d09024c180bb",
    "alive": true,
    "content": [
      "3904a7ce-58c8-4b27-ac4a-71944b4f2f07",
      "0dbec281-6e8d-4450-af20-4a8f4abfda1d",
      "0f98e9ea-ef00-4e3c-b898-fdde10cdf71b",
      "c9adaad5-fa76-44b2-a73b-afb0b7aece81",
      "d2045044-31b2-4b90-9db2-3034fbef5cf3",
      "daf9590f-9d33-45fa-8aa1-8425be9927e6",
      "40b7afcf-ee23-405a-a0bc-473c3b5f2087",
      "ce76c4cf-5087-449a-a416-ee021cc02ce9",
      "3a2d75c2-2aa7-4ed7-8c98-7827139985f1",
      "a9beccc4-0c01-472b-ae02-9404d0034ebc",
      "ceae57fb-625b-4ec1-85da-63cbb7e71614",
      "7a2544dc-32b4-499c-b5fb-f5f4d33f10f8",
      "306bc60e-495c-4cc5-8364-2503719a7f51",
      "bfa5cfd6-1aec-433c-809c-311c69586bb2",
      "85cdd978-c9ee-4df0-8970-042f8ee30858",
      "2220db6f-25a8-4ee8-ae2c-21257c9c0242"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1549528920579,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1550215500000,
    "parent_id": "2b5c894c-d50a-418f-a811-3b61a23cdead",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Pinned Object"
        ]
      ]
    },
    "type": "page",
    "version": 10,
    "content_resolved": [
      {
        "id": "3904a7ce-58c8-4b27-ac4a-71944b4f2f07",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920572,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920572,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "GC",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " (Garbage Collector) is responsible for cleaning our garbage."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "GC",
            "AttrFlags": 1
          },
          {
            "Text": " (Garbage Collector) is responsible for cleaning our garbage."
          }
        ]
      },
      {
        "id": "0dbec281-6e8d-4450-af20-4a8f4abfda1d",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920575,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920575,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "While "
            ],
            [
              "GC",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " cleans our garbage, he removes the unused objects from the managed heap which cause heap fragmentation. When "
            ],
            [
              "GC",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " is done with the removal, it performs a heap compression (defragmintation) which involves moving objects on the heap."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "While "
          },
          {
            "Text": "GC",
            "AttrFlags": 1
          },
          {
            "Text": " cleans our garbage, he removes the unused objects from the managed heap which cause heap fragmentation. When "
          },
          {
            "Text": "GC",
            "AttrFlags": 1
          },
          {
            "Text": " is done with the removal, it performs a heap compression (defragmintation) which involves moving objects on the heap."
          }
        ]
      },
      {
        "id": "0f98e9ea-ef00-4e3c-b898-fdde10cdf71b",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920575,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920575,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Since "
            ],
            [
              "GC",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " isn’t deterministic, when passing managed object reference/pointer to native code, "
            ],
            [
              "GC",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " can kick in at any time, if it occurs just after Inerop call, there is a very good possibility that object (which reference passed to native) will be moved on the managed heap - as a result, we get an invalid reference on managed side."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Since "
          },
          {
            "Text": "GC",
            "AttrFlags": 1
          },
          {
            "Text": " isn’t deterministic, when passing managed object reference/pointer to native code, "
          },
          {
            "Text": "GC",
            "AttrFlags": 1
          },
          {
            "Text": " can kick in at any time, if it occurs just after Inerop call, there is a very good possibility that object (which reference passed to native) will be moved on the managed heap - as a result, we get an invalid reference on managed side."
          }
        ]
      },
      {
        "id": "c9adaad5-fa76-44b2-a73b-afb0b7aece81",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920577,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920577,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "In this scenario, you should "
            ],
            [
              "pin",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " the object before passing it to native code."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "In this scenario, you should "
          },
          {
            "Text": "pin",
            "AttrFlags": 1
          },
          {
            "Text": " the object before passing it to native code."
          }
        ]
      },
      {
        "id": "d2045044-31b2-4b90-9db2-3034fbef5cf3",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920577,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920577,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Pinned Object",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Pinned Object",
            "AttrFlags": 1
          }
        ]
      },
      {
        "id": "daf9590f-9d33-45fa-8aa1-8425be9927e6",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920577,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920577,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Pinned object is an object that is not allowed to move by GC."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Pinned object is an object that is not allowed to move by GC."
          }
        ]
      },
      {
        "id": "40b7afcf-ee23-405a-a0bc-473c3b5f2087",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920577,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920577,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Gc Pinned Handle",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Gc Pinned Handle",
            "AttrFlags": 1
          }
        ]
      },
      {
        "id": "ce76c4cf-5087-449a-a416-ee021cc02ce9",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920577,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920577,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "You can create a pin object using "
            ],
            [
              "Gc.Alloc",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " method"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "You can create a pin object using "
          },
          {
            "Text": "Gc.Alloc",
            "AttrFlags": 1
          },
          {
            "Text": " method"
          }
        ]
      },
      {
        "id": "3a2d75c2-2aa7-4ed7-8c98-7827139985f1",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920578,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550215500000,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "C#"
            ]
          ],
          "title": [
            [
              "GCHandle handle = GCHandle.Alloc(yourObject, GCHandleType.Pinned);"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "GCHandle handle = GCHandle.Alloc(yourObject, GCHandleType.Pinned);",
        "code_language": "C#"
      },
      {
        "id": "a9beccc4-0c01-472b-ae02-9404d0034ebc",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920578,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920578,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Obtaining a pinned "
            ],
            [
              "GCHandle",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " to managed object marks a specific object as one that cannot be moved by "
            ],
            [
              "GC",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              ", until freeing the handle"
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "Obtaining a pinned "
          },
          {
            "Text": "GCHandle",
            "AttrFlags": 1
          },
          {
            "Text": " to managed object marks a specific object as one that cannot be moved by "
          },
          {
            "Text": "GC",
            "AttrFlags": 1
          },
          {
            "Text": ", until freeing the handle"
          }
        ]
      },
      {
        "id": "ceae57fb-625b-4ec1-85da-63cbb7e71614",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920578,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920578,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Example:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Example:"
          }
        ]
      },
      {
        "id": "7a2544dc-32b4-499c-b5fb-f5f4d33f10f8",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920578,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550215500000,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "C#"
            ]
          ],
          "title": [
            [
              "[DllImport(\"kernel32.dll\", SetLastError = true)]\npublic static extern void EnterCriticalSection(IntPtr ptr);\n\n[DllImport(\"kernel32.dll\", SetLastError = true)]\npublic static extern void LeaveCriticalSection(IntPtr ptr);\n       \npublic void EnterCriticalSection(CRITICAL_SECTION section)\n{\n    try\n    {\n        GCHandle handle = GCHandle.Alloc(section, GCHandleType.Pinned); \n        EnterCriticalSection(handle.AddrOfPinnedObject());\n        //Do Some Critical Work\n        LeaveCriticalSection(handle.AddrOfPinnedObject());\n    }\n    finaly\n    {\n        handle.Free()\n    }\n}"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "[DllImport(\"kernel32.dll\", SetLastError = true)]\npublic static extern void EnterCriticalSection(IntPtr ptr);\n\n[DllImport(\"kernel32.dll\", SetLastError = true)]\npublic static extern void LeaveCriticalSection(IntPtr ptr);\n       \npublic void EnterCriticalSection(CRITICAL_SECTION section)\n{\n    try\n    {\n        GCHandle handle = GCHandle.Alloc(section, GCHandleType.Pinned); \n        EnterCriticalSection(handle.AddrOfPinnedObject());\n        //Do Some Critical Work\n        LeaveCriticalSection(handle.AddrOfPinnedObject());\n    }\n    finaly\n    {\n        handle.Free()\n    }\n}",
        "code_language": "C#"
      },
      {
        "id": "306bc60e-495c-4cc5-8364-2503719a7f51",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920579,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920579,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Precautions",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Precautions",
            "AttrFlags": 1
          }
        ]
      },
      {
        "id": "bfa5cfd6-1aec-433c-809c-311c69586bb2",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920579,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920579,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "When pinning (especially large ones) object try to release the pinned "
            ],
            [
              "GcHandle",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " as fast as possible, since it interrupt heap defragmentation."
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "When pinning (especially large ones) object try to release the pinned "
          },
          {
            "Text": "GcHandle",
            "AttrFlags": 1
          },
          {
            "Text": " as fast as possible, since it interrupt heap defragmentation."
          }
        ]
      },
      {
        "id": "85cdd978-c9ee-4df0-8970-042f8ee30858",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1549528920579,
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1549528920579,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "If you forget to free "
            ],
            [
              "GcHandle",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " nothing will. Do it in a safe code section (such as finaly)"
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "If you forget to free "
          },
          {
            "Text": "GcHandle",
            "AttrFlags": 1
          },
          {
            "Text": " nothing will. Do it in a safe code section (such as finaly)"
          }
        ]
      },
      {
        "id": "2220db6f-25a8-4ee8-ae2c-21257c9c0242",
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550215500000,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550215500000,
        "parent_id": "919a4119-75fa-479f-9986-d09024c180bb",
        "parent_table": "block",
        "type": "text",
        "version": 3
      }
    ],
    "title": "Pinned Object",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "",
      "version": 94
    }
  ],
  "Tables": null
}