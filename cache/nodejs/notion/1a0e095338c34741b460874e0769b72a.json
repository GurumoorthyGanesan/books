{
  "ID": "1a0e0953-38c3-4741-b460-874e0769b72a",
  "Root": {
    "alive": true,
    "content": [
      "91e5972c-cb9d-41ca-809f-34a1dde86dbe",
      "60dab55d-03ae-4402-ad7a-39935e5227ce",
      "9766cb51-3750-43cd-a11a-ca9f06ae94e8",
      "8a22dcb9-9473-48b9-b9e2-327b8beca958",
      "af6ce8d2-0055-4079-b23f-c04c52920d83",
      "2287e679-f144-4093-a420-811ca853a747",
      "32b2f13c-397c-45e5-a6d7-949c497bd121",
      "f3bf7be7-3b88-4d07-b6a8-75faad5c167d",
      "e9ce530e-40ed-4c65-8969-563fbc6b41d1",
      "0fcfe84f-49a6-4624-a89e-1df095d4948c",
      "f4893b16-3822-449d-b54b-717d76a7ecd5",
      "d5e30039-2e42-40fe-bb4a-eb580938d6bc",
      "7cb693b5-94c1-4b51-a9b7-e82b9ffe5f45"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1552020395282,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "id": "1a0e0953-38c3-4741-b460-874e0769b72a",
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1552020395282,
    "parent_id": "3f00e5d7-0452-4f14-b4a3-a59296e6de64",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Deployment using PM2 without downtime."
        ]
      ]
    },
    "type": "page",
    "version": 3,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395278,
        "id": "91e5972c-cb9d-41ca-809f-34a1dde86dbe",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395278,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "ecosystem.json",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "ecosystem.json",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395280,
        "id": "60dab55d-03ae-4402-ad7a-39935e5227ce",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395280,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "{\n    \"name\": \"app-name\",\n    \"script\": \"server\",\n    \"exec_mode\": \"cluster\",\n    \"instances\": 0,    \n    \"wait_ready\": true\n    \"listen_timeout\": 10000,\n    \"kill_timeout\": 5000,\n}"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "{\n    \"name\": \"app-name\",\n    \"script\": \"server\",\n    \"exec_mode\": \"cluster\",\n    \"instances\": 0,    \n    \"wait_ready\": true\n    \"listen_timeout\": 10000,\n    \"kill_timeout\": 5000,\n}",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395280,
        "id": "9766cb51-3750-43cd-a11a-ca9f06ae94e8",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395280,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "wait_ready"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "wait_ready",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395280,
        "id": "8a22dcb9-9473-48b9-b9e2-327b8beca958",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395280,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Instead of reload waiting for listen event, wait for process.send(‘ready’);"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Instead of reload waiting for listen event, wait for process.send(‘ready’);"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395281,
        "id": "af6ce8d2-0055-4079-b23f-c04c52920d83",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395281,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "listen_timeout"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "listen_timeout",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395281,
        "id": "2287e679-f144-4093-a420-811ca853a747",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395281,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Time in ms before forcing a reload if app not listening."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Time in ms before forcing a reload if app not listening."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395281,
        "id": "32b2f13c-397c-45e5-a6d7-949c497bd121",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395281,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "kill_timeout"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "kill_timeout",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395281,
        "id": "f3bf7be7-3b88-4d07-b6a8-75faad5c167d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395281,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Time in ms before sending a final SIGKLL."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Time in ms before sending a final SIGKLL."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395281,
        "id": "e9ce530e-40ed-4c65-8969-563fbc6b41d1",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395281,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "server.js",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "server.js",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395281,
        "id": "0fcfe84f-49a6-4624-a89e-1df095d4948c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395281,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "const http = require('http');\nconst express = require('express');\n\nconst app = express();\nconst server = http.Server(app);\nconst port = 80;\n\nserver.listen(port, function() {\n    process.send('ready');\n});\n\nprocess.on('SIGINT', function() {\n    server.close(function() {\n        process.exit(0);\n    });\n});"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "const http = require('http');\nconst express = require('express');\n\nconst app = express();\nconst server = http.Server(app);\nconst port = 80;\n\nserver.listen(port, function() {\n    process.send('ready');\n});\n\nprocess.on('SIGINT', function() {\n    server.close(function() {\n        process.exit(0);\n    });\n});",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395281,
        "id": "f4893b16-3822-449d-b54b-717d76a7ecd5",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395281,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "You might need to wait for your application to have etablished connections with your DBs/caches/workers/whatever. PM2 needs to wait before considering your application as online. To do this, you need to provide "
            ],
            [
              "wait_ready: true",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " in a process file. This will make PM2 listen for that event. In your application you will need to add "
            ],
            [
              "process.send('ready');",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " when you want your application to be considered as ready."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "You might need to wait for your application to have etablished connections with your DBs/caches/workers/whatever. PM2 needs to wait before considering your application as online. To do this, you need to provide "
          },
          {
            "Text": "wait_ready: true",
            "AttrFlags": 2
          },
          {
            "Text": " in a process file. This will make PM2 listen for that event. In your application you will need to add "
          },
          {
            "Text": "process.send('ready');",
            "AttrFlags": 2
          },
          {
            "Text": " when you want your application to be considered as ready."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395281,
        "id": "d5e30039-2e42-40fe-bb4a-eb580938d6bc",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395281,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "When a process is stopped/restarted by PM2, some system signals are sent to your process in a given order."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "When a process is stopped/restarted by PM2, some system signals are sent to your process in a given order."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552020395282,
        "id": "7cb693b5-94c1-4b51-a9b7-e82b9ffe5f45",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552020395282,
        "parent_id": "1a0e0953-38c3-4741-b460-874e0769b72a",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "First a "
            ],
            [
              "SIGINT",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " a signal is sent to your processes, signal you can catch to know that your process is going to be stopped. If your application does not exit by itself before 1.6s (customizable) it will receive a "
            ],
            [
              "SIGKILL",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " signal to force the process exit. So if your application need to clean-up something states or jobs you can catch the "
            ],
            [
              "SIGINT",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " signal to prepare your application to exit."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "First a "
          },
          {
            "Text": "SIGINT",
            "AttrFlags": 2
          },
          {
            "Text": " a signal is sent to your processes, signal you can catch to know that your process is going to be stopped. If your application does not exit by itself before 1.6s (customizable) it will receive a "
          },
          {
            "Text": "SIGKILL",
            "AttrFlags": 2
          },
          {
            "Text": " signal to force the process exit. So if your application need to clean-up something states or jobs you can catch the "
          },
          {
            "Text": "SIGINT",
            "AttrFlags": 2
          },
          {
            "Text": " signal to prepare your application to exit."
          }
        ]
      }
    ],
    "title": "Deployment using PM2 without downtime.",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 18
    }
  ],
  "Tables": null
}