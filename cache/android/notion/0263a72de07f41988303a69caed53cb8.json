{
  "ID": "0263a72d-e07f-4198-8303-a69caed53cb8",
  "Root": {
    "alive": true,
    "content": [
      "4bff89d6-8262-4cbd-ad31-b9bb4ed32ced",
      "6c97f80b-369d-489f-9d48-13af874d96bf",
      "85f67a93-a6db-4f0b-8033-45ff514d0587",
      "a60293b7-861d-4611-ab24-f90c9181f488",
      "f7500efe-02ac-4207-9513-1fccc8b0ff13",
      "4e4173ca-f6ba-4042-97a4-244c2778c45e"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1550451166161,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "id": "0263a72d-e07f-4198-8303-a69caed53cb8",
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1550451166161,
    "parent_id": "4d9ab42a-8f21-4c13-9db4-9eecf9315a5d",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Verifying App Signature - Tamper Detection"
        ]
      ]
    },
    "type": "page",
    "version": 3,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550451166157,
        "id": "4bff89d6-8262-4cbd-ad31-b9bb4ed32ced",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550451166157,
        "parent_id": "0263a72d-e07f-4198-8303-a69caed53cb8",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "This technique details how to ensure that your .apk has been signed with your developer certificate, and leverages the fact that the certificate remains consistent and that only you have access to it. We can break this technique into 3 simple steps:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "This technique details how to ensure that your .apk has been signed with your developer certificate, and leverages the fact that the certificate remains consistent and that only you have access to it. We can break this technique into 3 simple steps:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550451166160,
        "id": "6c97f80b-369d-489f-9d48-13af874d96bf",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550451166160,
        "parent_id": "0263a72d-e07f-4198-8303-a69caed53cb8",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Find your developer certificate signature."
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "Find your developer certificate signature."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550451166160,
        "id": "85f67a93-a6db-4f0b-8033-45ff514d0587",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550451166160,
        "parent_id": "0263a72d-e07f-4198-8303-a69caed53cb8",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Embed your signature in a String constant in your app."
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "Embed your signature in a String constant in your app."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550451166160,
        "id": "a60293b7-861d-4611-ab24-f90c9181f488",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550451166160,
        "parent_id": "0263a72d-e07f-4198-8303-a69caed53cb8",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Check that the signature at runtime matches our embedded developer signature."
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "Check that the signature at runtime matches our embedded developer signature."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550451166160,
        "id": "f7500efe-02ac-4207-9513-1fccc8b0ff13",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550451166160,
        "parent_id": "0263a72d-e07f-4198-8303-a69caed53cb8",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Here’s the code snippet:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Here’s the code snippet:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1550451166161,
        "id": "4e4173ca-f6ba-4042-97a4-244c2778c45e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1550451166161,
        "parent_id": "0263a72d-e07f-4198-8303-a69caed53cb8",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "private static final int VALID = 0;\nprivate static final int INVALID = 1;\n\npublic static int checkAppSignature(Context context) {\n\ntry {\n      PackageInfo packageInfo = context.getPackageManager().getPackageInfo(context.getPackageName(), PackageManager.GET_SIGNATURES);\n\n      for (Signature signature : packageInfo.signatures) {\n\n        byte[] signatureBytes = signature.toByteArray();\n\n        MessageDigest md = MessageDigest.getInstance(\"SHA\");\n\n        md.update(signature.toByteArray());\n\n        final String currentSignature = Base64.encodeToString(md.digest(), Base64.DEFAULT);\n\n        Log.d(\"REMOVE_ME\", \"Include this string as a value for SIGNATURE:\" + currentSignature);\n\n        //compare signatures\n        if (SIGNATURE.equals(currentSignature)){\n          return VALID;\n        };\n      }\n    } catch (Exception e) {\n        //assumes an issue in checking signature., but we let the caller decide on what to do.\n    }\n\n    return INVALID;\n\n}"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "private static final int VALID = 0;\nprivate static final int INVALID = 1;\n\npublic static int checkAppSignature(Context context) {\n\ntry {\n      PackageInfo packageInfo = context.getPackageManager().getPackageInfo(context.getPackageName(), PackageManager.GET_SIGNATURES);\n\n      for (Signature signature : packageInfo.signatures) {\n\n        byte[] signatureBytes = signature.toByteArray();\n\n        MessageDigest md = MessageDigest.getInstance(\"SHA\");\n\n        md.update(signature.toByteArray());\n\n        final String currentSignature = Base64.encodeToString(md.digest(), Base64.DEFAULT);\n\n        Log.d(\"REMOVE_ME\", \"Include this string as a value for SIGNATURE:\" + currentSignature);\n\n        //compare signatures\n        if (SIGNATURE.equals(currentSignature)){\n          return VALID;\n        };\n      }\n    } catch (Exception e) {\n        //assumes an issue in checking signature., but we let the caller decide on what to do.\n    }\n\n    return INVALID;\n\n}",
        "code_language": "Plain Text"
      }
    ],
    "title": "Verifying App Signature - Tamper Detection",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 18
    }
  ],
  "Tables": null
}