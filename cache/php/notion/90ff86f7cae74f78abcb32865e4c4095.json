{
  "ID": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
  "Root": {
    "alive": true,
    "content": [
      "f0d5bd09-0279-4879-872a-ed1655060998",
      "e69ca9d1-323f-4562-9e5f-392e9d2cef0c",
      "728d21ea-98dd-43b0-b6fa-00213e39ab16",
      "fd1d4e48-6c44-49d8-a002-a264d65b4bea",
      "9d9e136e-6a6b-40ed-ba8c-506067b827d9",
      "60cb90ce-abef-46d8-8811-69e336874844",
      "57f6b876-6998-4f5d-bea9-7d0f86776975",
      "368f2b45-7cbc-4899-a208-bf35ffd1f83a",
      "84d40370-007d-42f4-a570-291c9e9207d8",
      "134b0708-2c0c-4dbd-bd29-0667460e1194",
      "2cbefcfe-45c3-4a15-bfad-eea331479360",
      "a5f8ef4c-65f2-43fe-8364-eb09e2dbfe7c",
      "6dcebbc9-36f7-4049-9afd-11978aa1da93",
      "7b2b7028-e119-4cbf-a41d-851e58b0dd8a",
      "1273191e-b328-48ba-9915-c7c9815080a8",
      "dff1010f-bf69-4de8-849d-97bba6a0f0ca",
      "c9ba4dfe-1669-4837-8369-028a71692e55",
      "e66e5286-b126-46ec-b274-58eaed69b89b",
      "d10d5247-73cb-4f81-ab96-1ddf9b54e42c",
      "a523fa48-2eff-42d4-b065-4c3a2ffd3823"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1552022415693,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1552022415693,
    "parent_id": "a3705b2a-2c83-4e42-b51b-b58874cdba41",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Sending multi-dimensional data and multiple files with CurlFile in one request"
        ]
      ]
    },
    "type": "page",
    "version": 3,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415686,
        "id": "f0d5bd09-0279-4879-872a-ed1655060998",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415686,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Let’s say we have a form like the one below. We want to send the data to our webserver via AJAX and from there to a script running on an external server."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Let’s say we have a form like the one below. We want to send the data to our webserver via AJAX and from there to a script running on an external server."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415689,
        "id": "e69ca9d1-323f-4562-9e5f-392e9d2cef0c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415689,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "source": [
            [
              "/tmp/5bdd0546-159f-40b2-93aa-7901a8d58e07/c425dfc98205476b13dad88d13024d9c1808c778.png"
            ]
          ]
        },
        "type": "image",
        "version": 1,
        "source": "/tmp/5bdd0546-159f-40b2-93aa-7901a8d58e07/c425dfc98205476b13dad88d13024d9c1808c778.png",
        "image_url": "https://www.notion.so/image/https:%2F%2Fwww.notion.so%2Ftmp%2F5bdd0546-159f-40b2-93aa-7901a8d58e07%2Fc425dfc98205476b13dad88d13024d9c1808c778.png"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415689,
        "id": "728d21ea-98dd-43b0-b6fa-00213e39ab16",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415689,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "So we have normal inputs, a multi-select field and a file dropzone where we can upload multiple files."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "So we have normal inputs, a multi-select field and a file dropzone where we can upload multiple files."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415689,
        "id": "fd1d4e48-6c44-49d8-a002-a264d65b4bea",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415689,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Assuming the AJAX POST request was successful we get the following data on PHP site:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Assuming the AJAX POST request was successful we get the following data on PHP site:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415689,
        "id": "9d9e136e-6a6b-40ed-ba8c-506067b827d9",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415689,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "// print_r($_POST)\n\nArray\n(\n    [first_name] =\u003e John\n    [last_name] =\u003e Doe\n    [activities] =\u003e Array\n        (\n            [0] =\u003e soccer\n            [1] =\u003e hiking\n        )\n)"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "// print_r($_POST)\n\nArray\n(\n    [first_name] =\u003e John\n    [last_name] =\u003e Doe\n    [activities] =\u003e Array\n        (\n            [0] =\u003e soccer\n            [1] =\u003e hiking\n        )\n)",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415689,
        "id": "60cb90ce-abef-46d8-8811-69e336874844",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415689,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "and the files should look like this"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "and the files should look like this"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415690,
        "id": "57f6b876-6998-4f5d-bea9-7d0f86776975",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415690,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "// print_r($_FILES)\n\nArray\n(\n    [upload] =\u003e Array\n        (\n            [name] =\u003e Array\n                (\n                    [0] =\u003e my_photo.jpg\n                    [1] =\u003e my_life.pdf\n                )\n\n            [type] =\u003e Array\n                (\n                    [0] =\u003e image/jpg\n                    [1] =\u003e application/pdf\n                )\n\n            [tmp_name] =\u003e Array\n                (\n                    [0] =\u003e /tmp/phpW5spji\n                    [1] =\u003e /tmp/phpWgnUeY\n                )\n\n            [error] =\u003e Array\n                (\n                    [0] =\u003e 0\n                    [1] =\u003e 0\n                )\n\n            [size] =\u003e Array\n                (\n                    [0] =\u003e 647548\n                    [1] =\u003e 643223\n                )\n\n        )\n\n)"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "// print_r($_FILES)\n\nArray\n(\n    [upload] =\u003e Array\n        (\n            [name] =\u003e Array\n                (\n                    [0] =\u003e my_photo.jpg\n                    [1] =\u003e my_life.pdf\n                )\n\n            [type] =\u003e Array\n                (\n                    [0] =\u003e image/jpg\n                    [1] =\u003e application/pdf\n                )\n\n            [tmp_name] =\u003e Array\n                (\n                    [0] =\u003e /tmp/phpW5spji\n                    [1] =\u003e /tmp/phpWgnUeY\n                )\n\n            [error] =\u003e Array\n                (\n                    [0] =\u003e 0\n                    [1] =\u003e 0\n                )\n\n            [size] =\u003e Array\n                (\n                    [0] =\u003e 647548\n                    [1] =\u003e 643223\n                )\n\n        )\n\n)",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415690,
        "id": "368f2b45-7cbc-4899-a208-bf35ffd1f83a",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415690,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "So far, so good. Now we want to send this data and files to the external server using cURL with the CurlFile Class"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "So far, so good. Now we want to send this data and files to the external server using cURL with the CurlFile Class"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415690,
        "id": "84d40370-007d-42f4-a570-291c9e9207d8",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415690,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Since cURL only accepts a simple but not a multi-dimensional array, we have to flatten the $_POST array first."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Since cURL only accepts a simple but not a multi-dimensional array, we have to flatten the $_POST array first."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415692,
        "id": "134b0708-2c0c-4dbd-bd29-0667460e1194",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415692,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "To do this, you could use "
            ],
            [
              "this function for example",
              [
                [
                  "a",
                  "http://codereview.stackexchange.com/a/14685"
                ]
              ]
            ],
            [
              " which gives you the following:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "To do this, you could use "
          },
          {
            "Text": "this function for example",
            "Link": "http://codereview.stackexchange.com/a/14685"
          },
          {
            "Text": " which gives you the following:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415692,
        "id": "2cbefcfe-45c3-4a15-bfad-eea331479360",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415692,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "// print_r($new_post_array)\n\nArray\n(\n    [first_name] =\u003e John\n    [last_name] =\u003e Doe\n    [activities[0]] =\u003e soccer\n    [activities[1]] =\u003e hiking\n)"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "// print_r($new_post_array)\n\nArray\n(\n    [first_name] =\u003e John\n    [last_name] =\u003e Doe\n    [activities[0]] =\u003e soccer\n    [activities[1]] =\u003e hiking\n)",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415692,
        "id": "a5f8ef4c-65f2-43fe-8364-eb09e2dbfe7c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415692,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The next step is to create CurlFile Objects for the uploaded files. This is done by the following loop:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "The next step is to create CurlFile Objects for the uploaded files. This is done by the following loop:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415692,
        "id": "6dcebbc9-36f7-4049-9afd-11978aa1da93",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415692,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "$files = array();\n\nforeach ($_FILES[\"upload\"][\"error\"] as $key =\u003e $error) {\n    if ($error == UPLOAD_ERR_OK) {\n\n        $files[\"upload[$key]\"] = curl_file_create(\n            $_FILES['upload']['tmp_name'][$key],\n            $_FILES['upload']['type'][$key],\n            $_FILES['upload']['name'][$key]\n        );\n    }\n}"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "$files = array();\n\nforeach ($_FILES[\"upload\"][\"error\"] as $key =\u003e $error) {\n    if ($error == UPLOAD_ERR_OK) {\n\n        $files[\"upload[$key]\"] = curl_file_create(\n            $_FILES['upload']['tmp_name'][$key],\n            $_FILES['upload']['type'][$key],\n            $_FILES['upload']['name'][$key]\n        );\n    }\n}",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415692,
        "id": "7b2b7028-e119-4cbf-a41d-851e58b0dd8a",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415692,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "curl_file_create is a helper function of the CurlFile Class and creates the CurlFile objects. We save each object in the $files array with keys named “upload[0]” and “upload[1]” for our two files."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "curl_file_create is a helper function of the CurlFile Class and creates the CurlFile objects. We save each object in the $files array with keys named “upload[0]” and “upload[1]” for our two files."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415692,
        "id": "1273191e-b328-48ba-9915-c7c9815080a8",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415692,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "We now have to combine the flattened post array and the files array and save it as $data like this:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "We now have to combine the flattened post array and the files array and save it as $data like this:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415693,
        "id": "dff1010f-bf69-4de8-849d-97bba6a0f0ca",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415693,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "$data = $new_post_array + $files;"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "$data = $new_post_array + $files;",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415693,
        "id": "c9ba4dfe-1669-4837-8369-028a71692e55",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415693,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The last step is to send the cURL request:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "The last step is to send the cURL request:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415693,
        "id": "e66e5286-b126-46ec-b274-58eaed69b89b",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415693,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "$ch = curl_init();\n\ncurl_setopt_array($ch, array(\n    CURLOPT_POST =\u003e 1,\n    CURLOPT_URL =\u003e \"https://api.externalserver.com/upload.php\",\n    CURLOPT_RETURNTRANSFER =\u003e 1,\n    CURLINFO_HEADER_OUT =\u003e 1,\n    CURLOPT_POSTFIELDS =\u003e $data\n));\n\n$result = curl_exec($ch);\n\ncurl_close ($ch);"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "$ch = curl_init();\n\ncurl_setopt_array($ch, array(\n    CURLOPT_POST =\u003e 1,\n    CURLOPT_URL =\u003e \"https://api.externalserver.com/upload.php\",\n    CURLOPT_RETURNTRANSFER =\u003e 1,\n    CURLINFO_HEADER_OUT =\u003e 1,\n    CURLOPT_POSTFIELDS =\u003e $data\n));\n\n$result = curl_exec($ch);\n\ncurl_close ($ch);",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415693,
        "id": "d10d5247-73cb-4f81-ab96-1ddf9b54e42c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415693,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Since $data is now a simple (flat) array, cURL automatically sends this POST request with Content Type: multipart/form-data"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Since $data is now a simple (flat) array, cURL automatically sends this POST request with Content Type: multipart/form-data"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552022415693,
        "id": "a523fa48-2eff-42d4-b065-4c3a2ffd3823",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552022415693,
        "parent_id": "90ff86f7-cae7-4f78-abcb-32865e4c4095",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "In upload.php on the external server you can now get the post data and files with $_POST and $_FILES as you would normally do."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "In upload.php on the external server you can now get the post data and files with $_POST and $_FILES as you would normally do."
          }
        ]
      }
    ],
    "title": "Sending multi-dimensional data and multiple files with CurlFile in one request",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 19
    }
  ],
  "Tables": null
}