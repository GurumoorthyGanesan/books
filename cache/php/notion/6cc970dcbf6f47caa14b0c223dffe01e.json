{
  "ID": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
  "Root": {
    "alive": true,
    "content": [
      "32bb8064-736e-4f33-80d5-555f8e651ddc",
      "6e840321-78d7-4484-ae5f-cd15eedb2b76",
      "11c7cfb9-875a-4dc6-b8bc-0aeb950b8090",
      "5012923d-1ea7-4529-bee8-ab076f28fc34",
      "9341bd94-2a24-4af6-ac7b-02338fcb1c99",
      "8cbda291-e218-4776-a054-173cca992907",
      "009b30e2-fdde-4280-8b05-000231f3f871",
      "b98d2f1a-d539-4d29-ba23-4289836a31ad",
      "59a4e261-a297-4916-9916-e95e4d267962",
      "4ea5d14b-be5e-459b-aae7-c6b908f467f5",
      "002cc0af-0866-4e05-b0fa-18309d611b1c",
      "40498e89-d93d-47d8-8ff0-bdae6bdc51db",
      "6d8497a7-e577-49c1-b859-ed4efd8efe01"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1552023042249,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1552023042249,
    "parent_id": "0eabffb2-1a8c-43e6-b5d0-24c02329f9d1",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Cross-Site Request Forgery"
        ]
      ]
    },
    "type": "page",
    "version": 3,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042247,
        "id": "32bb8064-736e-4f33-80d5-555f8e651ddc",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042247,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Problem"
            ]
          ]
        },
        "type": "sub_header",
        "version": 1,
        "inline_content": [
          {
            "Text": "Problem"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042248,
        "id": "6e840321-78d7-4484-ae5f-cd15eedb2b76",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042248,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Cross-Site Request Forgery or "
            ],
            [
              "CSRF",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " can force an end user to unknowingly generate malicious requests to a web server. This attack vector can be exploited in both POST and GET requests. Let’s say for example the url endpoint "
            ],
            [
              "/delete.php?accnt=12",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " deletes account as passed from "
            ],
            [
              "accnt",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " parameter of a GET request. Now if an authenticated user will encounter the following script in any other application"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Cross-Site Request Forgery or "
          },
          {
            "Text": "CSRF",
            "AttrFlags": 2
          },
          {
            "Text": " can force an end user to unknowingly generate malicious requests to a web server. This attack vector can be exploited in both POST and GET requests. Let’s say for example the url endpoint "
          },
          {
            "Text": "/delete.php?accnt=12",
            "AttrFlags": 2
          },
          {
            "Text": " deletes account as passed from "
          },
          {
            "Text": "accnt",
            "AttrFlags": 2
          },
          {
            "Text": " parameter of a GET request. Now if an authenticated user will encounter the following script in any other application"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042248,
        "id": "11c7cfb9-875a-4dc6-b8bc-0aeb950b8090",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042248,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "\u003cimg src=\"http://domain.com/delete.php?accnt=12\" width=\"0\" height=\"0\" border=\"0\"\u003e"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "\u003cimg src=\"http://domain.com/delete.php?accnt=12\" width=\"0\" height=\"0\" border=\"0\"\u003e",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042248,
        "id": "5012923d-1ea7-4529-bee8-ab076f28fc34",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042248,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "the account would be deleted."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "the account would be deleted."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042248,
        "id": "9341bd94-2a24-4af6-ac7b-02338fcb1c99",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042248,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Solution"
            ]
          ]
        },
        "type": "sub_header",
        "version": 1,
        "inline_content": [
          {
            "Text": "Solution"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042248,
        "id": "8cbda291-e218-4776-a054-173cca992907",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042248,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "A common solution to this problem is the use of "
            ],
            [
              "CSRF tokens",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              ". CSRF tokens are embedded into requests so that a web application can trust that a request came from an expected source as part of the application’s normal workflow. First the user performs some action, such as viewing a form, that triggers the creation of a unique token. A sample form implementing this might look like"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "A common solution to this problem is the use of "
          },
          {
            "Text": "CSRF tokens",
            "AttrFlags": 1
          },
          {
            "Text": ". CSRF tokens are embedded into requests so that a web application can trust that a request came from an expected source as part of the application’s normal workflow. First the user performs some action, such as viewing a form, that triggers the creation of a unique token. A sample form implementing this might look like"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042248,
        "id": "009b30e2-fdde-4280-8b05-000231f3f871",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042248,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "\u003cform method=\"get\" action=\"/delete.php\"\u003e\n  \u003cinput type=\"text\" name=\"accnt\" placeholder=\"accnt number\" /\u003e\n  \u003cinput type=\"hidden\" name=\"csrf_token\" value=\"\u003crandomToken\u003e\" /\u003e\n  \u003cinput type=\"submit\" /\u003e\n\u003c/form\u003e"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "\u003cform method=\"get\" action=\"/delete.php\"\u003e\n  \u003cinput type=\"text\" name=\"accnt\" placeholder=\"accnt number\" /\u003e\n  \u003cinput type=\"hidden\" name=\"csrf_token\" value=\"\u003crandomToken\u003e\" /\u003e\n  \u003cinput type=\"submit\" /\u003e\n\u003c/form\u003e",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042248,
        "id": "b98d2f1a-d539-4d29-ba23-4289836a31ad",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042248,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The token can then be validated by the server against the user session after form submission to eliminate malicious requests."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "The token can then be validated by the server against the user session after form submission to eliminate malicious requests."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042249,
        "id": "59a4e261-a297-4916-9916-e95e4d267962",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042249,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Sample code"
            ]
          ]
        },
        "type": "sub_header",
        "version": 1,
        "inline_content": [
          {
            "Text": "Sample code"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042249,
        "id": "4ea5d14b-be5e-459b-aae7-c6b908f467f5",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042249,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Here is sample code for a basic implementation:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Here is sample code for a basic implementation:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042249,
        "id": "002cc0af-0866-4e05-b0fa-18309d611b1c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042249,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "/* Code to generate a CSRF token and store the same */\n...\n\u003c?php\n  session_start();\n  function generate_token() {\n    // Check if a token is present for the current session\n    if(!isset($_SESSION[\"csrf_token\"])) {\n        // No token present, generate a new one\n        $token = random_bytes(64);\n        $_SESSION[\"csrf_token\"] = $token;\n    } else {\n        // Reuse the token\n        $token = $_SESSION[\"csrf_token\"];\n    }\n    return $token;\n  }\n?\u003e\n\u003cbody\u003e\n  \u003cform method=\"get\" action=\"/delete.php\"\u003e\n    \u003cinput type=\"text\" name=\"accnt\" placeholder=\"accnt number\" /\u003e\n    \u003cinput type=\"hidden\" name=\"csrf_token\" value=\"\u003c?php echo generate_token();?\u003e\" /\u003e\n    \u003cinput type=\"submit\" /\u003e\n  \u003c/form\u003e\n\u003c/body\u003e\n..."
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "/* Code to generate a CSRF token and store the same */\n...\n\u003c?php\n  session_start();\n  function generate_token() {\n    // Check if a token is present for the current session\n    if(!isset($_SESSION[\"csrf_token\"])) {\n        // No token present, generate a new one\n        $token = random_bytes(64);\n        $_SESSION[\"csrf_token\"] = $token;\n    } else {\n        // Reuse the token\n        $token = $_SESSION[\"csrf_token\"];\n    }\n    return $token;\n  }\n?\u003e\n\u003cbody\u003e\n  \u003cform method=\"get\" action=\"/delete.php\"\u003e\n    \u003cinput type=\"text\" name=\"accnt\" placeholder=\"accnt number\" /\u003e\n    \u003cinput type=\"hidden\" name=\"csrf_token\" value=\"\u003c?php echo generate_token();?\u003e\" /\u003e\n    \u003cinput type=\"submit\" /\u003e\n  \u003c/form\u003e\n\u003c/body\u003e\n...",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042249,
        "id": "40498e89-d93d-47d8-8ff0-bdae6bdc51db",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042249,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "/* Code to validate token and drop malicious requests */\n...\n\u003c?php\n  session_start();\n  if ($_GET[\"csrf_token\"] != $_SESSION[\"csrf_token\"]) {\n    // Reset token\n    unset($_SESSION[\"csrf_token\"]);\n    die(\"CSRF token validation failed\");\n  }\n?\u003e\n..."
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "/* Code to validate token and drop malicious requests */\n...\n\u003c?php\n  session_start();\n  if ($_GET[\"csrf_token\"] != $_SESSION[\"csrf_token\"]) {\n    // Reset token\n    unset($_SESSION[\"csrf_token\"]);\n    die(\"CSRF token validation failed\");\n  }\n?\u003e\n...",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023042249,
        "id": "6d8497a7-e577-49c1-b859-ed4efd8efe01",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023042249,
        "parent_id": "6cc970dc-bf6f-47ca-a14b-0c223dffe01e",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "There are many libraries and frameworks already available which have their own implementation of CSRF validation. Though this is the simple implementation of CSRF, You need to write some code to "
            ],
            [
              "regenerate",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " your CSRF token dynamically to prevent from CSRF token stealing and fixation."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "There are many libraries and frameworks already available which have their own implementation of CSRF validation. Though this is the simple implementation of CSRF, You need to write some code to "
          },
          {
            "Text": "regenerate",
            "AttrFlags": 1
          },
          {
            "Text": " your CSRF token dynamically to prevent from CSRF token stealing and fixation."
          }
        ]
      }
    ],
    "title": "Cross-Site Request Forgery",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 19
    }
  ],
  "Tables": null
}