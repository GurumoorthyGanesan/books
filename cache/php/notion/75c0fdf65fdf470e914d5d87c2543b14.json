{
  "ID": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
  "Root": {
    "alive": true,
    "content": [
      "2ee2ca61-3ebc-4351-bad3-901e2a81948c",
      "da2e6167-9052-474e-9560-6ca7930b62fa",
      "3de5317a-6dca-425c-829c-ffe2c3fb7338",
      "34a0a717-73f5-46d4-95ec-a0cb04788aa3",
      "b68976f1-6f16-4083-b592-6d1654204b34",
      "86aeaa48-ea43-4701-b8d2-1425197a9ebb",
      "a5e28a46-8e5e-4799-b523-4fac53d13f7f",
      "ad979cef-4faf-4620-8617-6231952d2f30",
      "4714d46f-eea5-43fa-921d-cfb27c9fee7f",
      "276a3175-57ee-4901-beeb-33357c4363a0",
      "f5175b9f-d77f-43a0-b59b-8c6bfc0db1b6",
      "2b87ad8a-82b2-4bfe-a1f2-edfd6a28e14c",
      "48c8f4af-62f6-4eb1-ba28-7e5820cff047",
      "dbf5bc7e-7de8-4fe8-9c51-b4519c955d2d",
      "57661196-423e-49bd-8c4c-518a36c6d07d",
      "7dd8c030-9add-4355-92af-c24956b7588d",
      "a233ff8d-3596-4e5b-a168-3b1a4ddfd82e"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1552023043140,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1552023043140,
    "parent_id": "0eabffb2-1a8c-43e6-b5d0-24c02329f9d1",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Command Line Injection"
        ]
      ]
    },
    "type": "page",
    "version": 3,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043131,
        "id": "2ee2ca61-3ebc-4351-bad3-901e2a81948c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043131,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Problem"
            ]
          ]
        },
        "type": "sub_header",
        "version": 1,
        "inline_content": [
          {
            "Text": "Problem"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043134,
        "id": "da2e6167-9052-474e-9560-6ca7930b62fa",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043134,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "In a similar way that SQL injection allows an attacker to execute arbitrary queries on a database, command-line injection allows someone to run untrusted system commands on a web server. With an improperly secured server this would give an attacker complete control over a system."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "In a similar way that SQL injection allows an attacker to execute arbitrary queries on a database, command-line injection allows someone to run untrusted system commands on a web server. With an improperly secured server this would give an attacker complete control over a system."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043134,
        "id": "3de5317a-6dca-425c-829c-ffe2c3fb7338",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043134,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Let’s say, for example, a script allows a user to list directory contents on a web server."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Let’s say, for example, a script allows a user to list directory contents on a web server."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043134,
        "id": "34a0a717-73f5-46d4-95ec-a0cb04788aa3",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043134,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "\u003cpre\u003e\n\u003c?php system('ls ' . $_GET['path']); ?\u003e\n\u003c/pre\u003e"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "\u003cpre\u003e\n\u003c?php system('ls ' . $_GET['path']); ?\u003e\n\u003c/pre\u003e",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043134,
        "id": "b68976f1-6f16-4083-b592-6d1654204b34",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043134,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "(In a real-world application one would use PHP’s built-in functions or objects to get path contents. This example is for a simple security demonstration.)",
              [
                [
                  "i"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "(In a real-world application one would use PHP’s built-in functions or objects to get path contents. This example is for a simple security demonstration.)",
            "AttrFlags": 4
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043134,
        "id": "86aeaa48-ea43-4701-b8d2-1425197a9ebb",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043134,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "One would hope to get a "
            ],
            [
              "path",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " parameter similar to "
            ],
            [
              "/tmp",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ". But as any input is allowed, "
            ],
            [
              "path",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " could be "
            ],
            [
              "; rm -fr /",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ". The web server would then execute the command"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "One would hope to get a "
          },
          {
            "Text": "path",
            "AttrFlags": 2
          },
          {
            "Text": " parameter similar to "
          },
          {
            "Text": "/tmp",
            "AttrFlags": 2
          },
          {
            "Text": ". But as any input is allowed, "
          },
          {
            "Text": "path",
            "AttrFlags": 2
          },
          {
            "Text": " could be "
          },
          {
            "Text": "; rm -fr /",
            "AttrFlags": 2
          },
          {
            "Text": ". The web server would then execute the command"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043135,
        "id": "a5e28a46-8e5e-4799-b523-4fac53d13f7f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043135,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "ls; rm -fr /"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "ls; rm -fr /",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043138,
        "id": "ad979cef-4faf-4620-8617-6231952d2f30",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043138,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "and attempt to delete all files from the root of the server."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "and attempt to delete all files from the root of the server."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043138,
        "id": "4714d46f-eea5-43fa-921d-cfb27c9fee7f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043138,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Solution"
            ]
          ]
        },
        "type": "sub_header",
        "version": 1,
        "inline_content": [
          {
            "Text": "Solution"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043138,
        "id": "276a3175-57ee-4901-beeb-33357c4363a0",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043138,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "All command arguments must be "
            ],
            [
              "escaped",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              " using "
            ],
            [
              "escapeshellarg()",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " or "
            ],
            [
              "escapeshellcmd()",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ". This makes the arguments non-executable. For each parameter, the input value should also be "
            ],
            [
              "validated",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              "."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "All command arguments must be "
          },
          {
            "Text": "escaped",
            "AttrFlags": 1
          },
          {
            "Text": " using "
          },
          {
            "Text": "escapeshellarg()",
            "AttrFlags": 2
          },
          {
            "Text": " or "
          },
          {
            "Text": "escapeshellcmd()",
            "AttrFlags": 2
          },
          {
            "Text": ". This makes the arguments non-executable. For each parameter, the input value should also be "
          },
          {
            "Text": "validated",
            "AttrFlags": 1
          },
          {
            "Text": "."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043138,
        "id": "f5175b9f-d77f-43a0-b59b-8c6bfc0db1b6",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043138,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "In the simplest case, we can secure our example with"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "In the simplest case, we can secure our example with"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043139,
        "id": "2b87ad8a-82b2-4bfe-a1f2-edfd6a28e14c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043139,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "\u003cpre\u003e\n\u003c?php system('ls ' . escapeshellarg($_GET['path'])); ?\u003e\n\u003c/pre\u003e"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "\u003cpre\u003e\n\u003c?php system('ls ' . escapeshellarg($_GET['path'])); ?\u003e\n\u003c/pre\u003e",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043139,
        "id": "48c8f4af-62f6-4eb1-ba28-7e5820cff047",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043139,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Following the previous example with the attempt to remove files, the executed command becomes"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Following the previous example with the attempt to remove files, the executed command becomes"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043139,
        "id": "dbf5bc7e-7de8-4fe8-9c51-b4519c955d2d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043139,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "ls '; rm -fr /'"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "ls '; rm -fr /'",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043139,
        "id": "57661196-423e-49bd-8c4c-518a36c6d07d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043139,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "And the string is simply passed as a parameter to "
            ],
            [
              "ls",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ", rather than terminating the "
            ],
            [
              "ls",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " command and running "
            ],
            [
              "rm",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              "."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "And the string is simply passed as a parameter to "
          },
          {
            "Text": "ls",
            "AttrFlags": 2
          },
          {
            "Text": ", rather than terminating the "
          },
          {
            "Text": "ls",
            "AttrFlags": 2
          },
          {
            "Text": " command and running "
          },
          {
            "Text": "rm",
            "AttrFlags": 2
          },
          {
            "Text": "."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043139,
        "id": "7dd8c030-9add-4355-92af-c24956b7588d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043139,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "It should be noted that the example above is now secure from command injection, but not from directory traversal. To fix this, it should be checked that the normalized path starts with the desired sub-directory."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "It should be noted that the example above is now secure from command injection, but not from directory traversal. To fix this, it should be checked that the normalized path starts with the desired sub-directory."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552023043140,
        "id": "a233ff8d-3596-4e5b-a168-3b1a4ddfd82e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552023043140,
        "parent_id": "75c0fdf6-5fdf-470e-914d-5d87c2543b14",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "PHP offers a variety of functions to execute system commands, including "
            ],
            [
              "exec",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ", "
            ],
            [
              "passthru",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ", "
            ],
            [
              "proc_open",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ", "
            ],
            [
              "shell_exec",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ", and "
            ],
            [
              "system",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ". All must have their inputs carefully validated and escaped."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "PHP offers a variety of functions to execute system commands, including "
          },
          {
            "Text": "exec",
            "AttrFlags": 2
          },
          {
            "Text": ", "
          },
          {
            "Text": "passthru",
            "AttrFlags": 2
          },
          {
            "Text": ", "
          },
          {
            "Text": "proc_open",
            "AttrFlags": 2
          },
          {
            "Text": ", "
          },
          {
            "Text": "shell_exec",
            "AttrFlags": 2
          },
          {
            "Text": ", and "
          },
          {
            "Text": "system",
            "AttrFlags": 2
          },
          {
            "Text": ". All must have their inputs carefully validated and escaped."
          }
        ]
      }
    ],
    "title": "Command Line Injection",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 19
    }
  ],
  "Tables": null
}