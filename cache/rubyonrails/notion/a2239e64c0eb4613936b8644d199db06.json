{
  "ID": "a2239e64-c0eb-4613-936b-8644d199db06",
  "Root": {
    "alive": true,
    "content": [
      "fe6892aa-c462-4d92-800c-e2aca6ea0cb8",
      "9325aa6c-f193-4c13-8a0e-8cc0fca7410d",
      "25c0d5bf-df78-4399-ba29-1c48f608892a",
      "4351ec1c-b927-4c4a-b85e-8f3ff4fb55ea",
      "24e47f81-1083-4c69-8e51-8ca7545f401f",
      "319c8349-1480-4d47-a880-1311fd3f185c",
      "774b5982-6f28-4344-82e4-5f23b2c48960",
      "e26c1b60-2306-4d42-ac72-3727f623f3eb",
      "2b5e59bf-a532-4cb5-8495-c97f6a697fb2",
      "86915885-b8bd-48dc-9e5e-faad720fe370",
      "4c026d60-96af-42bf-bd5e-15996142ca91",
      "f3f25e3c-f2aa-4bfe-a0dd-61c87ec7c946",
      "8f4f667d-5864-4025-b8e1-2242a7dc1a05",
      "17da2864-a27e-4ccc-89ae-f0132caced32"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1552103164233,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "id": "a2239e64-c0eb-4613-936b-8644d199db06",
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1552103164233,
    "parent_id": "b354d383-4db8-4609-8b0a-e58e843de7f1",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Get locale from HTTP request"
        ]
      ]
    },
    "type": "page",
    "version": 3,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164226,
        "id": "fe6892aa-c462-4d92-800c-e2aca6ea0cb8",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164226,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Sometimes it can be useful to set your application locale based upon the request IP. You can easily achieve this using "
            ],
            [
              "Geocoder",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              ". Among the many things "
            ],
            [
              "Geocoder",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              " does, it can also tell the "
            ],
            [
              "location",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " of a "
            ],
            [
              "request",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              "."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Sometimes it can be useful to set your application locale based upon the request IP. You can easily achieve this using "
          },
          {
            "Text": "Geocoder",
            "AttrFlags": 3
          },
          {
            "Text": ". Among the many things "
          },
          {
            "Text": "Geocoder",
            "AttrFlags": 3
          },
          {
            "Text": " does, it can also tell the "
          },
          {
            "Text": "location",
            "AttrFlags": 2
          },
          {
            "Text": " of a "
          },
          {
            "Text": "request",
            "AttrFlags": 2
          },
          {
            "Text": "."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164229,
        "id": "9325aa6c-f193-4c13-8a0e-8cc0fca7410d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164229,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "First, add "
            ],
            [
              "Geocoder",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              " to your "
            ],
            [
              "Gemfile",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "First, add "
          },
          {
            "Text": "Geocoder",
            "AttrFlags": 3
          },
          {
            "Text": " to your "
          },
          {
            "Text": "Gemfile",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164229,
        "id": "25c0d5bf-df78-4399-ba29-1c48f608892a",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164229,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "# Gemfile\ngem 'geocoder'"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "# Gemfile\ngem 'geocoder'",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164229,
        "id": "4351ec1c-b927-4c4a-b85e-8f3ff4fb55ea",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164229,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Geocoder",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              " adds "
            ],
            [
              "location",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " and "
            ],
            [
              "safe_location",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " methods to the standard "
            ],
            [
              "Rack::Request",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " object so you can easily look up the location of any HTTP request by IP address. You can use this methods in a "
            ],
            [
              "before_action",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " in your "
            ],
            [
              "ApplicationController",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ":"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Geocoder",
            "AttrFlags": 3
          },
          {
            "Text": " adds "
          },
          {
            "Text": "location",
            "AttrFlags": 2
          },
          {
            "Text": " and "
          },
          {
            "Text": "safe_location",
            "AttrFlags": 2
          },
          {
            "Text": " methods to the standard "
          },
          {
            "Text": "Rack::Request",
            "AttrFlags": 2
          },
          {
            "Text": " object so you can easily look up the location of any HTTP request by IP address. You can use this methods in a "
          },
          {
            "Text": "before_action",
            "AttrFlags": 2
          },
          {
            "Text": " in your "
          },
          {
            "Text": "ApplicationController",
            "AttrFlags": 2
          },
          {
            "Text": ":"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164229,
        "id": "24e47f81-1083-4c69-8e51-8ca7545f401f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164229,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "class ApplicationController \u003c ActionController::Base\n  before_action :set_locale_from_request\n\n  def set_locale_from_request\n    country_code = request.location.data[\"country_code\"] #=\u003e \"US\"\n    country_sym = country_code.underscore.to_sym #=\u003e :us\n\n    # If request locale is available use it, otherwise use I18n default locale\n    if I18n.available_locales.include? country_sym\n      I18n.locale = country_sym\n    end\nend"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "class ApplicationController \u003c ActionController::Base\n  before_action :set_locale_from_request\n\n  def set_locale_from_request\n    country_code = request.location.data[\"country_code\"] #=\u003e \"US\"\n    country_sym = country_code.underscore.to_sym #=\u003e :us\n\n    # If request locale is available use it, otherwise use I18n default locale\n    if I18n.available_locales.include? country_sym\n      I18n.locale = country_sym\n    end\nend",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164230,
        "id": "319c8349-1480-4d47-a880-1311fd3f185c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164230,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Beware that this will not work in "
            ],
            [
              "development",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " and "
            ],
            [
              "test",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " environments, as things like "
            ],
            [
              "0.0.0.0",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " and "
            ],
            [
              "localhost",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " are valid valid Internet IP addresses."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Beware that this will not work in "
          },
          {
            "Text": "development",
            "AttrFlags": 2
          },
          {
            "Text": " and "
          },
          {
            "Text": "test",
            "AttrFlags": 2
          },
          {
            "Text": " environments, as things like "
          },
          {
            "Text": "0.0.0.0",
            "AttrFlags": 2
          },
          {
            "Text": " and "
          },
          {
            "Text": "localhost",
            "AttrFlags": 2
          },
          {
            "Text": " are valid valid Internet IP addresses."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164230,
        "id": "774b5982-6f28-4344-82e4-5f23b2c48960",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164230,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "type": "divider",
        "version": 1
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164230,
        "id": "e26c1b60-2306-4d42-ac72-3727f623f3eb",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164230,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Limitations and alternatives"
            ]
          ]
        },
        "type": "header",
        "version": 1,
        "inline_content": [
          {
            "Text": "Limitations and alternatives"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164231,
        "id": "2b5e59bf-a532-4cb5-8495-c97f6a697fb2",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164231,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Geocoder",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              " is very powerful and flexible, but needs to be configured to work with a "
            ],
            [
              "geocoding service",
              [
                [
                  "i"
                ]
              ]
            ],
            [
              " (see "
            ],
            [
              "more details",
              [
                [
                  "a",
                  "https://github.com/alexreisner/geocoder#geocoding-service-lookup-configuration"
                ]
              ]
            ],
            [
              "); many of which place limits on usage. It’s also worth bearing in mind that calling an external service on every request could impact performance."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Geocoder",
            "AttrFlags": 3
          },
          {
            "Text": " is very powerful and flexible, but needs to be configured to work with a "
          },
          {
            "Text": "geocoding service",
            "AttrFlags": 4
          },
          {
            "Text": " (see "
          },
          {
            "Text": "more details",
            "Link": "https://github.com/alexreisner/geocoder#geocoding-service-lookup-configuration"
          },
          {
            "Text": "); many of which place limits on usage. It’s also worth bearing in mind that calling an external service on every request could impact performance."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164232,
        "id": "86915885-b8bd-48dc-9e5e-faad720fe370",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164232,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "To address these, it can also be worth considering:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "To address these, it can also be worth considering:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164232,
        "id": "4c026d60-96af-42bf-bd5e-15996142ca91",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164232,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "1. An offline solution"
            ]
          ]
        },
        "type": "sub_header",
        "version": 1,
        "inline_content": [
          {
            "Text": "1. An offline solution"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164232,
        "id": "f3f25e3c-f2aa-4bfe-a0dd-61c87ec7c946",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164232,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Using a gem like "
            ],
            [
              "GeoIP",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              " (see "
            ],
            [
              "here",
              [
                [
                  "a",
                  "https://github.com/cjheath/geoip"
                ]
              ]
            ],
            [
              ") allows lookups to happen against a local datafile. There may be a trade-off in terms of accuracy, as these datafiles need to be kept up-to-date."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Using a gem like "
          },
          {
            "Text": "GeoIP",
            "AttrFlags": 3
          },
          {
            "Text": " (see "
          },
          {
            "Text": "here",
            "Link": "https://github.com/cjheath/geoip"
          },
          {
            "Text": ") allows lookups to happen against a local datafile. There may be a trade-off in terms of accuracy, as these datafiles need to be kept up-to-date."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164232,
        "id": "8f4f667d-5864-4025-b8e1-2242a7dc1a05",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164232,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "2. Use CloudFlare"
            ]
          ]
        },
        "type": "sub_header",
        "version": 1,
        "inline_content": [
          {
            "Text": "2. Use CloudFlare"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103164233,
        "id": "17da2864-a27e-4ccc-89ae-f0132caced32",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103164233,
        "parent_id": "a2239e64-c0eb-4613-936b-8644d199db06",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Pages served through CloudFlare have the option of being geocoded transparently, with the country code being added to the header ("
            ],
            [
              "HTTP_CF_IPCOUNTRY",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              "). More detail can be found "
            ],
            [
              "here",
              [
                [
                  "a",
                  "https://support.cloudflare.com/hc/en-us/articles/200168236-What-does-Cloudflare-IP-Geolocation-do-"
                ]
              ]
            ],
            [
              "."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Pages served through CloudFlare have the option of being geocoded transparently, with the country code being added to the header ("
          },
          {
            "Text": "HTTP_CF_IPCOUNTRY",
            "AttrFlags": 2
          },
          {
            "Text": "). More detail can be found "
          },
          {
            "Text": "here",
            "Link": "https://support.cloudflare.com/hc/en-us/articles/200168236-What-does-Cloudflare-IP-Geolocation-do-"
          },
          {
            "Text": "."
          }
        ]
      }
    ],
    "title": "Get locale from HTTP request",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 19
    }
  ],
  "Tables": null
}