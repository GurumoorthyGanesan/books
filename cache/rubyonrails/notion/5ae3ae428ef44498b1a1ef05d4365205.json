{
  "ID": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
  "Root": {
    "alive": true,
    "content": [
      "644f4674-3b8c-40c4-8ed9-4f90b653b183",
      "8ba50d28-3f1c-42ec-af06-d4ab266b9133",
      "3678abd7-1f62-4c81-84be-5bc09c402e8b",
      "62c43e23-8649-429a-8564-0b54af85be0e",
      "8299b024-fb87-492a-9d8a-716547a8d591",
      "720cbf88-96f7-459e-94e7-f76350494c16",
      "291172b6-bacf-4c49-b501-922aa697b15d",
      "1283215a-02b1-43b0-aac3-112437eb3b85",
      "105a1647-b7d2-4e9b-b48a-ef24db27972d",
      "f0aa26e9-63a4-4191-ac96-58abd51317bb",
      "d4ac7068-4973-4000-9f4e-f3f9222fb33f",
      "2b0ee86b-1687-4d63-9b2c-2b3ef9acdd0c",
      "a5ad58fa-0d63-45a8-8b51-3c823029e0cd",
      "649fe510-54d1-4438-b4a6-9d48d8007a71",
      "561f8f8e-226b-416b-9206-40918c3a227a",
      "40a26ea3-7e32-43a3-bd33-4fd7f6e272be",
      "b9eb5de6-131e-4e7c-a611-adbfb9537024",
      "d3342b53-6416-431a-8a33-c126847fcc1c",
      "3de2068a-1818-4142-80ab-1d9d5a23efbd",
      "3ee956e9-6feb-46cd-acc9-e75e5dce72f6",
      "02e12821-54dd-4f77-a178-d9f8e814f34e",
      "339a7728-b0b1-47ee-b7f5-387f4e5949d3",
      "171fc36b-1624-4955-bea4-2088a22f740a",
      "d3010772-4328-41d4-934f-e123db7e47dc",
      "7fdad392-5c64-4e75-9099-2e63cffc722e",
      "e70c7960-ff5f-4fc8-aa49-ca7081ab7904",
      "05d9ef43-9337-4039-a7fd-020a741c3bae",
      "bad7cd73-eacd-4f6e-aab5-43a4840a9ff9",
      "1730f90b-073b-4c0f-93a4-3eb19b4b02d3",
      "0e9cbdc9-0865-4bbe-9e60-8ea629308c12",
      "504c7a66-f8dd-459e-bcb4-abcab1bd467f",
      "bc440993-bc95-4f39-b212-2e34f8c445de",
      "1a1b4fd6-85aa-4e7d-8cae-480c83cd372d",
      "de7b0f90-ff42-4c2d-a39a-6bc92caf15e2",
      "25329ba5-63f4-4610-ac58-1bc9a0964f5f",
      "c33bdfea-1572-440f-adeb-2cd45b5f0e33",
      "ab6258f2-1e17-4997-bcf0-5c17682f7aa0"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1552103077010,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1552103077010,
    "parent_id": "4e24aeae-4196-4d0d-b517-818819e2a0fa",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Beware of default scope"
        ]
      ]
    },
    "type": "page",
    "version": 3,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077002,
        "id": "644f4674-3b8c-40c4-8ed9-4f90b653b183",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077002,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "ActiveRecord includes "
            ],
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ", to automatically scope a model by default."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "ActiveRecord includes "
          },
          {
            "Text": "default_scope",
            "AttrFlags": 2
          },
          {
            "Text": ", to automatically scope a model by default."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077005,
        "id": "8ba50d28-3f1c-42ec-af06-d4ab266b9133",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077005,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "class Post\n  default_scope -\u003e{ where(published: true).order(created_at: :desc) }\nend"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "class Post\n  default_scope -\u003e{ where(published: true).order(created_at: :desc) }\nend",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077005,
        "id": "3678abd7-1f62-4c81-84be-5bc09c402e8b",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077005,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The above code will serve posts which are already published when you perform any query on the model."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "The above code will serve posts which are already published when you perform any query on the model."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077005,
        "id": "62c43e23-8649-429a-8564-0b54af85be0e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077005,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "Post.all # will only list published posts"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "Post.all # will only list published posts",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077006,
        "id": "8299b024-fb87-492a-9d8a-716547a8d591",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077006,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "That scope, while innocuous-looking, has multiple hidden side-effect that you may not want."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "That scope, while innocuous-looking, has multiple hidden side-effect that you may not want."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077006,
        "id": "720cbf88-96f7-459e-94e7-f76350494c16",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077006,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " and "
            ],
            [
              "order",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "sub_sub_header",
        "version": 1,
        "inline_content": [
          {
            "Text": "default_scope",
            "AttrFlags": 2
          },
          {
            "Text": " and "
          },
          {
            "Text": "order",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077006,
        "id": "291172b6-bacf-4c49-b501-922aa697b15d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077006,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Since you declared an "
            ],
            [
              "order",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " in the "
            ],
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ", calling "
            ],
            [
              "order",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " on "
            ],
            [
              "Post",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " will be added as additional orders instead of overriding the default."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Since you declared an "
          },
          {
            "Text": "order",
            "AttrFlags": 2
          },
          {
            "Text": " in the "
          },
          {
            "Text": "default_scope",
            "AttrFlags": 2
          },
          {
            "Text": ", calling "
          },
          {
            "Text": "order",
            "AttrFlags": 2
          },
          {
            "Text": " on "
          },
          {
            "Text": "Post",
            "AttrFlags": 2
          },
          {
            "Text": " will be added as additional orders instead of overriding the default."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077006,
        "id": "1283215a-02b1-43b0-aac3-112437eb3b85",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077006,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "Post.order(updated_at: :desc)"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "Post.order(updated_at: :desc)",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077006,
        "id": "105a1647-b7d2-4e9b-b48a-ef24db27972d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077006,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "SELECT \"posts\".* FROM \"posts\" WHERE \"posts\".\"published\" = 't' ORDER BY \"posts\".\"created_at\" DESC, \"posts\".\"updated_at\" DESC"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "SELECT \"posts\".* FROM \"posts\" WHERE \"posts\".\"published\" = 't' ORDER BY \"posts\".\"created_at\" DESC, \"posts\".\"updated_at\" DESC",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077006,
        "id": "f0aa26e9-63a4-4191-ac96-58abd51317bb",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077006,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "This is probably not the behavior you wanted; you can override this by excluding the "
            ],
            [
              "order",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " from the scope first"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "This is probably not the behavior you wanted; you can override this by excluding the "
          },
          {
            "Text": "order",
            "AttrFlags": 2
          },
          {
            "Text": " from the scope first"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077006,
        "id": "d4ac7068-4973-4000-9f4e-f3f9222fb33f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077006,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "Post.except(:order).order(updated_at: :desc)"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "Post.except(:order).order(updated_at: :desc)",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077006,
        "id": "2b0ee86b-1687-4d63-9b2c-2b3ef9acdd0c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077006,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "SELECT \"posts\".* FROM \"posts\" WHERE \"posts\".\"published\" = 't' ORDER BY \"posts\".\"updated_at\" DESC"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "SELECT \"posts\".* FROM \"posts\" WHERE \"posts\".\"published\" = 't' ORDER BY \"posts\".\"updated_at\" DESC",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077007,
        "id": "a5ad58fa-0d63-45a8-8b51-3c823029e0cd",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077007,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " and model initialization"
            ]
          ]
        },
        "type": "header",
        "version": 1,
        "inline_content": [
          {
            "Text": "default_scope",
            "AttrFlags": 2
          },
          {
            "Text": " and model initialization"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077007,
        "id": "649fe510-54d1-4438-b4a6-9d48d8007a71",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077007,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "As with any other "
            ],
            [
              "ActiveRecord::Relation",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ", "
            ],
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " will alter the default state of models initialized from it."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "As with any other "
          },
          {
            "Text": "ActiveRecord::Relation",
            "AttrFlags": 2
          },
          {
            "Text": ", "
          },
          {
            "Text": "default_scope",
            "AttrFlags": 2
          },
          {
            "Text": " will alter the default state of models initialized from it."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077007,
        "id": "561f8f8e-226b-416b-9206-40918c3a227a",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077007,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "In the above example, "
            ],
            [
              "Post",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " has "
            ],
            [
              "where(published: true)",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " set by default, and so new models from "
            ],
            [
              "Post",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " will also have it set."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "In the above example, "
          },
          {
            "Text": "Post",
            "AttrFlags": 2
          },
          {
            "Text": " has "
          },
          {
            "Text": "where(published: true)",
            "AttrFlags": 2
          },
          {
            "Text": " set by default, and so new models from "
          },
          {
            "Text": "Post",
            "AttrFlags": 2
          },
          {
            "Text": " will also have it set."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077007,
        "id": "40a26ea3-7e32-43a3-bd33-4fd7f6e272be",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077007,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "Post.new # =\u003e \u003cPost published: true\u003e"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "Post.new # =\u003e \u003cPost published: true\u003e",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077007,
        "id": "b9eb5de6-131e-4e7c-a611-adbfb9537024",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077007,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "unscoped",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "header",
        "version": 1,
        "inline_content": [
          {
            "Text": "unscoped",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077007,
        "id": "d3342b53-6416-431a-8a33-c126847fcc1c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077007,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " can nominally be cleared by calling "
            ],
            [
              "unscoped",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " first, but this also has side-effects. Take, for example, an STI model:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "default_scope",
            "AttrFlags": 2
          },
          {
            "Text": " can nominally be cleared by calling "
          },
          {
            "Text": "unscoped",
            "AttrFlags": 2
          },
          {
            "Text": " first, but this also has side-effects. Take, for example, an STI model:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077007,
        "id": "3de2068a-1818-4142-80ab-1d9d5a23efbd",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077007,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "class Post \u003c Document\n  default_scope -\u003e{ where(published: true).order(created_at: :desc) }\nend"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "class Post \u003c Document\n  default_scope -\u003e{ where(published: true).order(created_at: :desc) }\nend",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077008,
        "id": "3ee956e9-6feb-46cd-acc9-e75e5dce72f6",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077008,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "By default, queries against "
            ],
            [
              "Post",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " will be scoped to "
            ],
            [
              "type",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " columns containing "
            ],
            [
              "'Post'",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ". But "
            ],
            [
              "unscoped",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " will clear this along with your own "
            ],
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ", so if you use "
            ],
            [
              "unscoped",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " you have to remember to account for this as well."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "By default, queries against "
          },
          {
            "Text": "Post",
            "AttrFlags": 2
          },
          {
            "Text": " will be scoped to "
          },
          {
            "Text": "type",
            "AttrFlags": 2
          },
          {
            "Text": " columns containing "
          },
          {
            "Text": "'Post'",
            "AttrFlags": 2
          },
          {
            "Text": ". But "
          },
          {
            "Text": "unscoped",
            "AttrFlags": 2
          },
          {
            "Text": " will clear this along with your own "
          },
          {
            "Text": "default_scope",
            "AttrFlags": 2
          },
          {
            "Text": ", so if you use "
          },
          {
            "Text": "unscoped",
            "AttrFlags": 2
          },
          {
            "Text": " you have to remember to account for this as well."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077008,
        "id": "02e12821-54dd-4f77-a178-d9f8e814f34e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077008,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "Post.unscoped.where(type: 'Post').order(updated_at: :desc)"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "Post.unscoped.where(type: 'Post').order(updated_at: :desc)",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077008,
        "id": "339a7728-b0b1-47ee-b7f5-387f4e5949d3",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077008,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "unscoped",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " and Model Associations"
            ]
          ]
        },
        "type": "header",
        "version": 1,
        "inline_content": [
          {
            "Text": "unscoped",
            "AttrFlags": 2
          },
          {
            "Text": " and Model Associations"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077008,
        "id": "171fc36b-1624-4955-bea4-2088a22f740a",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077008,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Consider a relationship between "
            ],
            [
              "Post",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " and "
            ],
            [
              "User",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Consider a relationship between "
          },
          {
            "Text": "Post",
            "AttrFlags": 2
          },
          {
            "Text": " and "
          },
          {
            "Text": "User",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077008,
        "id": "d3010772-4328-41d4-934f-e123db7e47dc",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077008,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "class Post \u003c ApplicationRecord\n  belongs_to :user\n  default_scope -\u003e{ where(published: true).order(created_at: :desc) }\nend\n\nclass User \u003c ApplicationRecord\n  has_many :posts\nend"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "class Post \u003c ApplicationRecord\n  belongs_to :user\n  default_scope -\u003e{ where(published: true).order(created_at: :desc) }\nend\n\nclass User \u003c ApplicationRecord\n  has_many :posts\nend",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077008,
        "id": "7fdad392-5c64-4e75-9099-2e63cffc722e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077008,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "By getting an individual "
            ],
            [
              "User",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ", you can see the posts related to it:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "By getting an individual "
          },
          {
            "Text": "User",
            "AttrFlags": 2
          },
          {
            "Text": ", you can see the posts related to it:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077008,
        "id": "e70c7960-ff5f-4fc8-aa49-ca7081ab7904",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077008,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "user = User.find(1)\nuser.posts"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "user = User.find(1)\nuser.posts",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077008,
        "id": "05d9ef43-9337-4039-a7fd-020a741c3bae",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077008,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "SELECT \"posts\".* FROM \"posts\" WHERE \"posts\".\"published\" = 't' AND \"posts\".\"user_id\" = ? ORDER BY \"posts\".\"created_at\" DESC [[\"user_id\", 1]]"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "SELECT \"posts\".* FROM \"posts\" WHERE \"posts\".\"published\" = 't' AND \"posts\".\"user_id\" = ? ORDER BY \"posts\".\"created_at\" DESC [[\"user_id\", 1]]",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077009,
        "id": "bad7cd73-eacd-4f6e-aab5-43a4840a9ff9",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077009,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "But you want to clear the "
            ],
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " from the "
            ],
            [
              "posts",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " relation, so you use "
            ],
            [
              "unscoped",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "But you want to clear the "
          },
          {
            "Text": "default_scope",
            "AttrFlags": 2
          },
          {
            "Text": " from the "
          },
          {
            "Text": "posts",
            "AttrFlags": 2
          },
          {
            "Text": " relation, so you use "
          },
          {
            "Text": "unscoped",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077009,
        "id": "1730f90b-073b-4c0f-93a4-3eb19b4b02d3",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077009,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "user.posts.unscoped"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "user.posts.unscoped",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077009,
        "id": "0e9cbdc9-0865-4bbe-9e60-8ea629308c12",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077009,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "SELECT \"posts\".* FROM \"posts\""
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "SELECT \"posts\".* FROM \"posts\"",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077009,
        "id": "504c7a66-f8dd-459e-bcb4-abcab1bd467f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077009,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "This wipes out the "
            ],
            [
              "user_id",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " condition as well as the "
            ],
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              "."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "This wipes out the "
          },
          {
            "Text": "user_id",
            "AttrFlags": 2
          },
          {
            "Text": " condition as well as the "
          },
          {
            "Text": "default_scope",
            "AttrFlags": 2
          },
          {
            "Text": "."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077009,
        "id": "bc440993-bc95-4f39-b212-2e34f8c445de",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077009,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "An example use-case for "
            ],
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "header",
        "version": 1,
        "inline_content": [
          {
            "Text": "An example use-case for "
          },
          {
            "Text": "default_scope",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077009,
        "id": "1a1b4fd6-85aa-4e7d-8cae-480c83cd372d",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077009,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Despite all of that, there are situations where using "
            ],
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " is justifiable."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Despite all of that, there are situations where using "
          },
          {
            "Text": "default_scope",
            "AttrFlags": 2
          },
          {
            "Text": " is justifiable."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077009,
        "id": "de7b0f90-ff42-4c2d-a39a-6bc92caf15e2",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077009,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Consider a multi-tenant system where multiple subdomains are served from the same application but with isolated data. One way to achieve this isolation is through "
            ],
            [
              "default_scope",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ". The downsides in other cases become upsides here."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Consider a multi-tenant system where multiple subdomains are served from the same application but with isolated data. One way to achieve this isolation is through "
          },
          {
            "Text": "default_scope",
            "AttrFlags": 2
          },
          {
            "Text": ". The downsides in other cases become upsides here."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077010,
        "id": "25329ba5-63f4-4610-ac58-1bc9a0964f5f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077010,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "class ApplicationRecord \u003c ActiveRecord::Base\n  def self.inherited(subclass)\n    super\n\n    return unless subclass.superclass == self\n    return unless subclass.column_names.include? 'tenant_id'\n\n    subclass.class_eval do\n      default_scope -\u003e{ where(tenant_id: Tenant.current_id) }\n    end\n  end\nend"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "class ApplicationRecord \u003c ActiveRecord::Base\n  def self.inherited(subclass)\n    super\n\n    return unless subclass.superclass == self\n    return unless subclass.column_names.include? 'tenant_id'\n\n    subclass.class_eval do\n      default_scope -\u003e{ where(tenant_id: Tenant.current_id) }\n    end\n  end\nend",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077010,
        "id": "c33bdfea-1572-440f-adeb-2cd45b5f0e33",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077010,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "All you need to do is set "
            ],
            [
              "Tenant.current_id",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " to something early in the request, and any table that contains "
            ],
            [
              "tenant_id",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " will automatically become scoped without any additional code. Instantiating records will automatically inherit the tenant id they were created under."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "All you need to do is set "
          },
          {
            "Text": "Tenant.current_id",
            "AttrFlags": 2
          },
          {
            "Text": " to something early in the request, and any table that contains "
          },
          {
            "Text": "tenant_id",
            "AttrFlags": 2
          },
          {
            "Text": " will automatically become scoped without any additional code. Instantiating records will automatically inherit the tenant id they were created under."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552103077010,
        "id": "ab6258f2-1e17-4997-bcf0-5c17682f7aa0",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552103077010,
        "parent_id": "5ae3ae42-8ef4-4498-b1a1-ef05d4365205",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The important thing about this use-case is that the scope is set once per request, and it doesn’t change. The only cases you will need "
            ],
            [
              "unscoped",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " here are special cases like background workers that run outside of a request scope."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "The important thing about this use-case is that the scope is set once per request, and it doesn’t change. The only cases you will need "
          },
          {
            "Text": "unscoped",
            "AttrFlags": 2
          },
          {
            "Text": " here are special cases like background workers that run outside of a request scope."
          }
        ]
      }
    ],
    "title": "Beware of default scope",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 19
    }
  ],
  "Tables": null
}