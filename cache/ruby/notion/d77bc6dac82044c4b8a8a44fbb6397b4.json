{
  "ID": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
  "Root": {
    "alive": true,
    "content": [
      "d9955ab4-1c96-4377-ac61-8db824350297",
      "21ae6bf4-44d5-46b0-ab2b-c04b09f18bdb",
      "7fa292c0-e8f8-459a-a0b8-054dbed44eb7",
      "5e316a76-6743-4070-bf61-7dec0a382abd",
      "eaab4643-2300-44dd-b93f-ffe2fe660c28",
      "075fb218-a1de-48de-8c96-38271f05b103",
      "9bcd623f-0ce2-4a8a-89be-82e7387ab394",
      "2cc5c459-510c-4633-aad7-ef02d7137055",
      "2ffb5ec0-8d57-4d76-9daa-b1891a26554c",
      "2c8cc7d1-d79d-4fca-a5d2-64e6177b01d6",
      "f8431025-a59e-4bd0-80fb-94c09922025e",
      "0adda779-f91d-4548-8d5b-68ac8b81403f",
      "d77b105b-fb51-4ad0-9b45-fa527cc02ef2",
      "14f26eb5-f7a6-49af-b310-68cce0d955c2",
      "bb498482-6b12-48f0-b39d-73adf56dbeb5",
      "77c57968-eb77-4b23-a632-0509d2da85bc",
      "71ed852c-7f8e-4b28-bfae-7f83b2c3e524",
      "6b326949-4f60-4f5d-84c6-49f5d0cd8236"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1552101352841,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1552101352841,
    "parent_id": "c5283f07-4be2-4750-9418-3727592670e2",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Proxy"
        ]
      ]
    },
    "type": "page",
    "version": 3,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352838,
        "id": "d9955ab4-1c96-4377-ac61-8db824350297",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352838,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Proxy object is often used to ensure guarded access to another object, which internal business logic we don’t want to pollute with safety requirements."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Proxy object is often used to ensure guarded access to another object, which internal business logic we don’t want to pollute with safety requirements."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352838,
        "id": "21ae6bf4-44d5-46b0-ab2b-c04b09f18bdb",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352838,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Suppose we’d like to guarantee that only user of specific permissions can access resource."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Suppose we’d like to guarantee that only user of specific permissions can access resource."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352838,
        "id": "7fa292c0-e8f8-459a-a0b8-054dbed44eb7",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352838,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Proxy definition: (it ensure that only users which actually can see reservations will be able to consumer reservation_service)"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Proxy definition: (it ensure that only users which actually can see reservations will be able to consumer reservation_service)"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352838,
        "id": "5e316a76-6743-4070-bf61-7dec0a382abd",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352838,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "class Proxy\n  def initialize(current_user, reservation_service)\n    @current_user = current_user\n    @reservation_service = reservation_service\n  end\n\n  def highest_total_price_reservations(date_from, date_to, reservations_count)\n    if @current_user.can_see_reservations?\n      @reservation_service.highest_total_price_reservations(\n        date_from, \n        date_to, \n        reservations_count\n      )\n    else\n      []\n    end\n  end \nend"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "class Proxy\n  def initialize(current_user, reservation_service)\n    @current_user = current_user\n    @reservation_service = reservation_service\n  end\n\n  def highest_total_price_reservations(date_from, date_to, reservations_count)\n    if @current_user.can_see_reservations?\n      @reservation_service.highest_total_price_reservations(\n        date_from, \n        date_to, \n        reservations_count\n      )\n    else\n      []\n    end\n  end \nend",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352839,
        "id": "eaab4643-2300-44dd-b93f-ffe2fe660c28",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352839,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Models and ReservationService:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Models and ReservationService:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352839,
        "id": "075fb218-a1de-48de-8c96-38271f05b103",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352839,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "class Reservation\n  attr_reader :total_price, :date\n\n  def initialize(date, total_price)\n    @date = date\n    @total_price = total_price\n  end\nend\n\nclass ReservationService\n  def highest_total_price_reservations(date_from, date_to, reservations_count)\n    # normally it would be read from database/external service\n    reservations = [\n      Reservation.new(Date.new(2014, 5, 15), 100),\n      Reservation.new(Date.new(2017, 5, 15), 10),          \n      Reservation.new(Date.new(2017, 1, 15), 50)\n    ]\n\n    filtered_reservations = reservations.select do |reservation|\n      reservation.date.between?(date_from, date_to) \n    end\n\n    filtered_reservations.take(reservations_count)\n  end\nend        \n\nclass User\n  attr_reader :name\n\n  def initialize(can_see_reservations, name)\n    @can_see_reservations = can_see_reservations\n    @name = name\n  end\n\n  def can_see_reservations?\n    @can_see_reservations\n  end\nend"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "class Reservation\n  attr_reader :total_price, :date\n\n  def initialize(date, total_price)\n    @date = date\n    @total_price = total_price\n  end\nend\n\nclass ReservationService\n  def highest_total_price_reservations(date_from, date_to, reservations_count)\n    # normally it would be read from database/external service\n    reservations = [\n      Reservation.new(Date.new(2014, 5, 15), 100),\n      Reservation.new(Date.new(2017, 5, 15), 10),          \n      Reservation.new(Date.new(2017, 1, 15), 50)\n    ]\n\n    filtered_reservations = reservations.select do |reservation|\n      reservation.date.between?(date_from, date_to) \n    end\n\n    filtered_reservations.take(reservations_count)\n  end\nend        \n\nclass User\n  attr_reader :name\n\n  def initialize(can_see_reservations, name)\n    @can_see_reservations = can_see_reservations\n    @name = name\n  end\n\n  def can_see_reservations?\n    @can_see_reservations\n  end\nend",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352839,
        "id": "9bcd623f-0ce2-4a8a-89be-82e7387ab394",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352839,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Consumer service:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Consumer service:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352839,
        "id": "2cc5c459-510c-4633-aad7-ef02d7137055",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352839,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "class StatsService\n  def initialize(reservation_service)\n    @reservation_service = reservation_service\n  end\n\n  def year_top_100_reservations_average_total_price(year)\n    reservations = @reservation_service.highest_total_price_reservations(\n      Date.new(year, 1, 1),\n      Date.new(year, 12, 31),\n      100\n    )\n\n    if reservations.length \u003e 0\n      sum = reservations.reduce(0) do |memo, reservation| \n        memo + reservation.total_price\n      end\n\n      sum / reservations.length\n    else\n      0\n    end\n  end\nend"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "class StatsService\n  def initialize(reservation_service)\n    @reservation_service = reservation_service\n  end\n\n  def year_top_100_reservations_average_total_price(year)\n    reservations = @reservation_service.highest_total_price_reservations(\n      Date.new(year, 1, 1),\n      Date.new(year, 12, 31),\n      100\n    )\n\n    if reservations.length \u003e 0\n      sum = reservations.reduce(0) do |memo, reservation| \n        memo + reservation.total_price\n      end\n\n      sum / reservations.length\n    else\n      0\n    end\n  end\nend",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352839,
        "id": "2ffb5ec0-8d57-4d76-9daa-b1891a26554c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352839,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Test:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Test:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352839,
        "id": "2c8cc7d1-d79d-4fca-a5d2-64e6177b01d6",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352839,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "def test(user, year)\n  reservations_service = Proxy.new(user, ReservationService.new)\n  stats_service = StatsService.new(reservations_service)\n  average_price = stats_service.year_top_100_reservations_average_total_price(year)\n  puts \"#{user.name} will see: #{average_price}\"\nend\n\ntest(User.new(true, \"John the Admin\"), 2017)\ntest(User.new(false, \"Guest\"),         2017)"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "def test(user, year)\n  reservations_service = Proxy.new(user, ReservationService.new)\n  stats_service = StatsService.new(reservations_service)\n  average_price = stats_service.year_top_100_reservations_average_total_price(year)\n  puts \"#{user.name} will see: #{average_price}\"\nend\n\ntest(User.new(true, \"John the Admin\"), 2017)\ntest(User.new(false, \"Guest\"),         2017)",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352839,
        "id": "f8431025-a59e-4bd0-80fb-94c09922025e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352839,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "type": "divider",
        "version": 1
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352839,
        "id": "0adda779-f91d-4548-8d5b-68ac8b81403f",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352839,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "BENEFITS",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "sub_sub_header",
        "version": 1,
        "inline_content": [
          {
            "Text": "BENEFITS",
            "AttrFlags": 1
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352840,
        "id": "d77b105b-fb51-4ad0-9b45-fa527cc02ef2",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352840,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "we’re avoiding any changes in ",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              "ReservationService",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              " when access restrictions are changed.",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "we’re avoiding any changes in ",
            "AttrFlags": 1
          },
          {
            "Text": "ReservationService",
            "AttrFlags": 3
          },
          {
            "Text": " when access restrictions are changed.",
            "AttrFlags": 1
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352840,
        "id": "14f26eb5-f7a6-49af-b310-68cce0d955c2",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352840,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "we’re not mixing business related data (",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              "date_from",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              ", ",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              "date_to",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              ", ",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              "reservations_count",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              ") with domain unrelated concepts (user permissions) in service.",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "we’re not mixing business related data (",
            "AttrFlags": 1
          },
          {
            "Text": "date_from",
            "AttrFlags": 3
          },
          {
            "Text": ", ",
            "AttrFlags": 1
          },
          {
            "Text": "date_to",
            "AttrFlags": 3
          },
          {
            "Text": ", ",
            "AttrFlags": 1
          },
          {
            "Text": "reservations_count",
            "AttrFlags": 3
          },
          {
            "Text": ") with domain unrelated concepts (user permissions) in service.",
            "AttrFlags": 1
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352840,
        "id": "bb498482-6b12-48f0-b39d-73adf56dbeb5",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352840,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Consumer (",
              [
                [
                  "b"
                ]
              ]
            ],
            [
              "StatsService",
              [
                [
                  "b"
                ],
                [
                  "c"
                ]
              ]
            ],
            [
              ") is free from permissions related logic as well",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "Consumer (",
            "AttrFlags": 1
          },
          {
            "Text": "StatsService",
            "AttrFlags": 3
          },
          {
            "Text": ") is free from permissions related logic as well",
            "AttrFlags": 1
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352841,
        "id": "77c57968-eb77-4b23-a632-0509d2da85bc",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352841,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "type": "divider",
        "version": 1
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352841,
        "id": "71ed852c-7f8e-4b28-bfae-7f83b2c3e524",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352841,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "CAVEATS",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "sub_sub_header",
        "version": 1,
        "inline_content": [
          {
            "Text": "CAVEATS",
            "AttrFlags": 1
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1552101352841,
        "id": "6b326949-4f60-4f5d-84c6-49f5d0cd8236",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1552101352841,
        "parent_id": "d77bc6da-c820-44c4-b8a8-a44fbb6397b4",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Proxy interface is always exactly the same as the object it hides, so that user that consumes service wrapped by proxy wasn’t even aware of proxy presence."
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "Proxy interface is always exactly the same as the object it hides, so that user that consumes service wrapped by proxy wasn’t even aware of proxy presence."
          }
        ]
      }
    ],
    "title": "Proxy",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 19
    }
  ],
  "Tables": null
}